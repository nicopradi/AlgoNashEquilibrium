# Data Stackelberg game with capacity, continuous price
import numpy as np

def getData():
    ''' Construct a dictionary containing all the data_file
        Returns:
            dict          dictionarry containing all the data
    '''
    # Initialize the output dictionary
    dict = {}

    # Number of alternatives in the choice set (without considering opt-out)
    dict['I'] = 2

    # Number of customers
    dict['N'] = 5

    # Number of draws
    dict['R'] = 100

    # Lower and upper bound on prices
    dict['lb_p'] = np.array([0, 0.00, 0.00]) # lower bound (FSP, PSP, PUP)
    dict['ub_p'] = np.array([0, 1.00, 1.00]) # upper bound (FSP, PSP, PUP)

    dict['capacity'] = np.array([60.0, 20.0, 20.0]) # Availability for each alternative (opt-out always available)
    # Choice set of the customers
    #	 		           n1 n2 n3...
    dict['choice_set'] = np.array([[1, 1, 1, 1, 1],  # OPT-OUT
                       			  [1, 1, 1, 1, 1],  # PSP
                    	 		  [1, 1, 1, 1, 1]])  # PUP

    # Parameters choice model
    dict['ASC_PSP'] = 32
    dict['ASC_PUP'] = 34
    dict['Beta_TD'] = -0.612
    dict['Beta_Origin'] = -5.762
    dict['Beta_Age_Veh'] = 4.037
    dict['Beta_FEE_INC_PSP'] = -10.995
    dict['Beta_FEE_RES_PSP'] = -11.440
    dict['Beta_FEE_INC_PUP'] = -13.729
    dict['Beta_FEE_RES_PUP'] = -10.668

    # AT coefficient
    dict['Beta_AT'] = -0.788

    # FEE coefficient
    dict['Beta_FEE'] = -32.328

    # Random term (Gumbel distribution (0,1)) - 3 alternatives x 5 customers x 100 draws
    dict['xi'] = np.array([[[ -2.58046830e+00,  -5.71284900e-01,  -5.97796600e-01,
          -6.97346400e-01,  -1.19880500e-01,   9.25200000e-01,
          -7.37970800e-01,   1.04569800e-01,  -2.69363880e+00,
          -3.54297500e-01,   6.79506700e-01,   4.41470000e-01,
          -1.04418160e+00,   6.46320900e-01,  -1.94010100e+00,
           4.94356000e-02,  -7.61266300e-01,  -2.78396000e-01,
           5.41343200e-01,  -4.66120700e-01,  -2.00417500e-01,
          -6.08776800e-01,  -2.24447900e-01,   3.53589300e-01,
           4.91239500e-01,  -5.24512400e-01,   4.98824600e-01,
           1.50353000e-01,  -1.79522140e+00,  -5.35143700e-01,
           8.94739300e-01,  -4.85149200e-01,  -6.31078000e-01,
          -1.15275800e+00,   3.52910600e-01,  -1.57967900e-01,
          -9.42867300e-01,  -5.73883600e-01,  -1.45114870e+00,
          -1.76849920e+00,   1.85033300e-01,   2.94492500e-01,
           1.39313600e-01,   7.16388700e-01,   3.50650300e-01,
           8.07480100e-01,   8.58002500e-01,  -1.67016680e+00,
           6.78478100e-01,   2.97438500e-01,  -6.03403900e-01,
          -1.43759500e-01,   1.55091100e+00,   5.58629100e-01,
           5.88469800e-01,   1.25336940e+00,   6.46320900e-01,
           4.52858500e-01,  -9.74563700e-01,  -2.57608800e-01,
          -3.62064200e-01,  -1.93860800e-01,  -1.35213080e+00,
          -1.97497600e-01,  -8.82521300e-01,  -5.65453800e-01,
          -1.03977100e-01,  -2.80405420e+00,  -4.48223270e+00,
          -1.17951080e+00,   8.05853000e-02,  -5.87986400e-01,
          -2.87748700e-01,  -1.85814980e+00,   8.07285600e-01,
          -8.07196000e-01,  -7.72224200e-01,   4.54437400e-01,
           4.98862200e-01,   1.07470630e+00,  -1.87814380e+00,
           6.45600600e-01,  -1.40080800e-01,  -1.27144810e+00,
           7.70450000e-03,   6.77542800e-01,   1.11879720e+00,
          -8.47355500e-01,  -2.31220000e+00,   1.02882480e+00,
          -1.86835000e-01,   3.51548300e-01,  -1.52175030e+00,
          -2.91276990e+00,  -1.30711910e+00,  -1.51145030e+00,
          -2.67766230e+00,  -6.67270100e-01,  -5.37353370e+00,
          -6.40906000e-02],
        [  8.97504700e-01,   6.75590000e-03,   1.89586700e-01,
          -3.85430000e-03,  -3.54247640e+00,  -1.18792280e+00,
           4.49999700e-01,   2.88834900e-01,   1.01162130e+00,
          -3.92060650e+00,   2.55679500e-01,   1.13211000e+00,
           1.67338700e-01,   1.04351000e-02,  -1.21989660e+00,
           1.39819240e+00,   1.56455250e+00,  -2.49268590e+00,
          -6.30900200e-01,  -2.24005070e+00,  -1.23253800e-01,
          -3.05691030e+00,   6.01065800e-01,  -5.22574400e-01,
          -7.62599500e-01,  -6.18687000e-02,   1.35792810e+00,
           5.68705000e-01,  -1.54828100e-01,  -4.94156840e+00,
          -1.61611190e+00,  -2.97283700e-01,  -9.42723900e-01,
          -2.65363250e+00,   9.50898800e-01,  -5.96896600e-01,
           1.11562690e+00,  -6.75831700e-01,  -1.78719700e-01,
           6.00998300e-01,   3.18825500e-01,   1.85313500e-01,
          -2.49798800e-01,  -7.13078800e-01,  -1.49590870e+00,
          -1.10658690e+00,   1.82810500e-01,  -4.19163800e-01,
          -1.16112790e+00,   8.76656100e-01,  -6.38627000e-01,
           8.96151000e-01,  -3.80914700e+00,  -1.75327990e+00,
           8.01924300e-01,  -9.12609000e-01,   8.59682800e-01,
           2.19607900e-01,   1.11380620e+00,   1.30228300e+00,
          -2.71859780e+00,   7.76993200e-01,   4.63233900e-01,
           6.01255500e-01,   1.43303390e+00,  -7.05668800e-01,
          -1.07451450e+00,  -5.40360900e-01,  -1.34257500e+00,
          -3.95206010e+00,   1.74581800e-01,  -3.51764100e+00,
          -2.66099270e+00,  -2.69089100e-01,   5.58629100e-01,
           5.78671000e-01,  -2.81088000e-02,  -1.92287520e+00,
          -2.57393300e-01,   9.36578100e-01,  -1.93924900e-01,
          -7.32692000e-02,   6.07713000e-02,   6.79001000e-01,
           7.40730300e-01,  -1.77289230e+00,   4.16043800e-01,
          -2.84554670e+00,   3.09376200e-01,  -1.37668560e+00,
           6.14989500e-01,  -2.10241240e+00,  -1.72571720e+00,
          -4.29595360e+00,   1.49728370e+00,   9.50898800e-01,
          -1.48009300e-01,  -2.30349360e+00,  -6.79779200e-01,
           5.88327000e-02],
        [ -3.18162160e+00,   6.65637900e-01,   4.73875200e-01,
          -6.47982800e-01,   6.88172200e-01,  -1.26043000e-01,
          -5.49698400e-01,  -1.55273360e+00,   2.36888000e-02,
           1.01451770e+00,   1.27849290e+00,  -9.17992600e-01,
          -1.28396750e+00,  -7.23963400e-01,  -1.41589060e+00,
          -5.65070800e-01,  -5.25231300e-01,  -1.26450790e+00,
          -1.30690990e+00,  -3.31371200e-01,  -6.28879300e-01,
          -1.12467920e+00,  -1.48009300e-01,  -2.29997430e+00,
          -3.80636800e+00,  -1.24848990e+00,  -2.35136110e+00,
           1.50555280e+00,  -2.20886960e+00,  -5.79282440e+00,
           9.42446000e-02,   6.85933600e-01,  -2.71730000e-02,
          -1.40399700e-01,   6.30773900e-01,   8.40668800e-01,
          -9.51234100e-01,   8.63713000e-02,  -2.16039210e+00,
           1.66614200e-01,   7.66202200e-01,  -4.91705000e-02,
          -1.18193700e+00,  -8.49878900e-01,  -7.85380700e-01,
          -6.70447900e-01,   2.97667600e-01,  -1.09804150e+00,
          -3.02235510e+00,  -4.91902400e-01,   5.87163700e-01,
           4.95441300e-01,   5.31263000e-02,   1.02564000e+00,
          -2.97767460e+00,   3.03154800e-01,  -7.06697300e-01,
           1.10606470e+00,  -1.07375370e+00,  -4.22376600e-01,
          -1.72365570e+00,  -3.26616090e+00,  -9.54777900e-01,
           6.54218000e-01,  -2.73557670e+00,  -2.92638890e+00,
           5.17862300e-01,  -2.29320400e-01,   2.50192200e-01,
          -1.84020980e+00,   5.29653000e-02,  -1.31627030e+00,
           1.29598770e+00,  -3.30859730e+00,   4.93499800e-01,
           1.61723600e+00,  -4.20870420e+00,   4.11560300e-01,
           1.09382100e-01,   9.51730400e-01,  -9.13005200e-01,
          -3.98929960e+00,  -6.39692600e-01,  -5.63238890e+00,
           1.30481020e+00,  -6.87850000e-03,   6.71089000e-01,
          -1.03907010e+00,  -7.55009300e-01,   1.62121960e+00,
          -1.50866440e+00,  -3.06946200e-01,  -8.38065300e-01,
          -5.50353700e-01,  -3.04447000e-01,  -4.33058770e+00,
           8.35182500e-01,  -4.56892300e-01,  -1.89627120e+00,
          -1.46959710e+00],
        [ -8.32968800e-01,  -1.96911560e+00,   8.72912000e-01,
           1.51119900e-01,  -3.98745900e-01,  -2.96684620e+00,
          -1.90387090e+00,  -3.82250060e+00,  -6.11501900e-01,
          -2.55157750e+00,  -1.69258980e+00,   2.27277500e-01,
           8.53454600e-01,   7.67837000e-02,  -2.16540290e+00,
          -1.19967230e+00,   2.86759000e-01,  -2.86116500e-01,
          -1.57872890e+00,  -1.30690990e+00,  -1.06817750e+00,
          -1.34538720e+00,  -6.11644500e-01,  -1.70007060e+00,
           7.40652700e-01,  -3.38712150e+00,  -3.16038400e-01,
           3.01021900e-01,  -9.70596000e-01,  -1.62863710e+00,
           8.91334700e-01,   1.42300300e-01,  -3.51764100e+00,
          -6.05720900e-01,  -6.17677200e-01,  -3.19486900e-01,
          -5.71284900e-01,   2.01943400e-01,   9.61240100e-01,
          -1.58717600e-01,  -1.90387090e+00,  -5.80931000e-02,
           6.15485400e-01,   5.88469800e-01,  -2.37064600e+00,
          -1.76203710e+00,   1.23982580e+00,  -2.19147360e+00,
           6.42171800e-01,   3.92594700e-01,  -8.44172300e-01,
          -1.09497500e-01,  -9.79459300e-01,  -1.32133200e-01,
          -3.50903340e+00,   1.37417300e-01,  -5.19830300e-01,
          -4.04977700e-01,  -8.34070000e-02,  -2.05859330e+00,
           2.35364900e-01,  -3.32001030e+00,   4.97720200e-01,
           9.34624600e-01,  -3.02049700e-01,   1.02564000e+00,
           1.57261000e-02,  -4.55030100e-01,  -4.82863000e-02,
          -2.92039100e-01,  -7.83661300e-01,  -3.30859730e+00,
          -2.19820500e-01,  -1.12551470e+00,   6.88245300e-01,
          -4.82396100e-01,  -3.19119100e-01,  -1.62366990e+00,
          -3.86239910e+00,  -6.77188200e-01,   7.34594400e-01,
          -7.07200900e-01,  -1.21206380e+00,  -3.42668700e-01,
           1.01084000e-02,  -1.68986050e+00,  -5.90361300e-01,
           3.85084600e-01,  -5.89593600e+00,   1.65215400e-01,
          -1.17932600e-01,  -2.71730000e-02,  -1.86499370e+00,
          -3.33504130e+00,  -6.42863500e-01,  -2.79593900e-01,
          -2.05427430e+00,   5.29753100e-01,  -2.32588110e+00,
          -2.00319440e+00],
        [ -7.52058800e-01,   1.41266200e-01,   7.92040600e-01,
           5.62235100e-01,  -1.58717600e-01,  -3.70320480e+00,
           8.81990400e-01,   6.94112000e-02,  -5.59483600e-01,
           1.01831860e+00,  -6.76574800e-01,  -6.82738300e-01,
          -4.47074500e-01,  -2.55624000e-02,   5.34841000e-02,
           9.42277200e-01,   3.44410500e-01,  -1.86219000e-01,
           8.11731200e-01,  -7.89816200e-01,  -2.06031500e-01,
           8.87380000e-01,   9.79061000e-02,  -4.22931000e-02,
           5.42614100e-01,  -2.22522900e+00,   4.63233900e-01,
          -8.89125000e-01,  -3.13692200e+00,   1.07957270e+00,
           4.41470000e-01,   1.49277400e-01,   2.54741800e-01,
           1.18049080e+00,  -1.02873420e+00,  -3.03056800e-01,
           9.20099300e-01,   1.75046000e-02,  -6.77000600e-01,
           1.87748900e-01,  -4.28995700e-01,   1.11914400e-01,
          -9.67120000e-03,   1.13982050e+00,  -7.03724900e-01,
          -2.52563360e+00,  -1.96620000e-02,  -1.29757400e-01,
          -3.44589830e+00,  -1.09003420e+00,   7.19097000e-02,
          -1.50520010e+00,  -1.86219000e-01,   1.21914100e-01,
          -2.79377090e+00,   9.71175000e-01,   1.99489000e-01,
          -2.72440230e+00,  -1.18661210e+00,  -2.27866090e+00,
          -1.43630480e+00,   2.87387200e-01,  -3.18608480e+00,
          -1.15539470e+00,  -1.05101360e+00,  -1.58318970e+00,
           1.41266200e-01,   1.11380620e+00,   2.11057900e-01,
          -7.61143300e-01,  -1.28396750e+00,   2.09808500e-01,
          -1.16475830e+00,   2.52594400e-01,   6.64698100e-01,
          -6.38171800e-01,   5.72646000e-02,  -2.90474900e-01,
           3.88631500e-01,  -2.14397410e+00,  -5.80601400e-01,
           1.33992960e+00,  -6.10121800e-01,  -1.87181600e+00,
          -1.66278690e+00,  -6.88678200e-01,   1.19246550e+00,
          -4.81524000e-01,  -1.84493290e+00,  -1.00176000e-02,
          -3.47979520e+00,   1.09762060e+00,  -6.15556300e-01,
           3.50650300e-01,  -3.06062060e+00,  -9.95097700e-01,
           2.32145300e-01,  -2.37379350e+00,   1.99029700e-01,
          -4.57691200e-01]],

       [[  2.49625300e-01,  -1.27406760e+00,  -2.17433050e+00,
          -1.13650270e+00,  -8.50595700e-01,   1.04872350e+00,
           2.09808500e-01,   4.78696200e-01,  -1.99878550e+00,
           6.61504300e-01,   1.84022000e-01,   4.11780600e-01,
          -5.45301230e+00,  -7.26132200e-01,   8.13483200e-01,
          -2.28799950e+00,   7.98925500e-01,   5.60463600e-01,
           7.98925500e-01,  -5.26630800e-01,   1.03874270e+00,
           5.62235100e-01,   1.20531330e+00,  -1.76073860e+00,
          -3.19119100e-01,  -2.25759900e-01,  -8.32182900e-01,
           9.24659000e-02,   4.56974600e-01,  -2.44955180e+00,
          -5.78508900e-01,   7.62712200e-01,  -1.40512720e+00,
          -1.30112500e+00,   4.72068200e-01,   1.89092100e-01,
          -4.38297100e-01,  -7.55009300e-01,   1.09645200e+00,
          -2.31763200e-01,  -8.82521300e-01,  -3.52466600e-01,
          -2.71850500e-01,   1.64296300e-01,  -1.49864800e-01,
          -6.49039300e-01,  -6.40906000e-02,  -2.48411720e+00,
           6.94560000e-02,   6.08393200e-01,  -6.13948900e-01,
           5.12870100e-01,  -1.84530090e+00,  -1.38455210e+00,
          -1.13984390e+00,  -2.53913070e+00,  -4.20744700e-01,
          -1.70769300e-01,   5.22602600e-01,  -2.07270160e+00,
          -1.15404700e-01,   1.11385000e-02,   9.98663400e-01,
           6.43209800e-01,   9.79264300e-01,  -2.01892730e+00,
          -1.55568680e+00,  -2.44885300e+00,   2.29261800e-01,
          -9.25771700e-01,   4.44536900e-01,   5.34841000e-02,
          -2.04410680e+00,  -1.86505600e-01,  -4.44063400e-01,
           1.06723980e+00,  -3.61203600e-01,  -1.67576790e+00,
           1.43225200e+00,  -6.61659400e-01,  -1.59834310e+00,
          -1.10658690e+00,  -2.88075510e+00,   7.16388700e-01,
           5.81783100e-01,  -1.54592180e+00,   4.38165700e-01,
           7.84474700e-01,   5.98078900e-01,  -4.92558200e-01,
          -2.05004660e+00,   2.17400000e-03,  -1.54592180e+00,
           6.24981600e-01,  -9.53991300e-01,   3.43366000e-01,
           2.74327800e-01,   5.36067400e-01,   2.65026700e-01,
           6.01319500e-01],
        [ -6.29181500e-01,  -2.89124080e+00,  -8.50509200e-01,
          -2.22522900e+00,   8.81990400e-01,  -3.85030200e-01,
           7.49644100e-01,  -1.37019890e+00,   4.11233800e-01,
           1.04856970e+00,   6.92983300e-01,  -2.22522900e+00,
          -7.69935300e-01,  -1.05946620e+00,   1.70636500e-01,
          -6.58322100e-01,   4.31613700e-01,  -4.53323590e+00,
          -2.32702240e+00,   5.44577700e-01,  -1.94163510e+00,
           1.02408960e+00,   1.28999590e+00,  -1.15299700e-01,
          -5.04128200e-01,   6.22819300e-01,  -1.20836130e+00,
           1.22471090e+00,  -3.22011000e-02,  -1.40884030e+00,
          -1.87866380e+00,   4.41470000e-01,  -1.81079270e+00,
           2.92928000e-02,   2.26240900e-01,  -8.61224000e-02,
          -3.67565230e+00,  -2.16051200e-01,   1.17152950e+00,
          -2.19827200e+00,  -4.84046200e-01,  -2.51328330e+00,
           4.95354900e-01,  -2.24633940e+00,  -3.55761650e+00,
          -1.45726630e+00,  -1.99230590e+00,  -2.09077600e-01,
           4.33674000e-01,  -2.24005070e+00,  -3.17938700e-01,
           4.73875200e-01,  -7.64929100e-01,   2.94193000e-01,
           7.01119900e-01,  -3.48578000e-01,   8.79680000e-01,
          -9.37662100e-01,  -1.23559490e+00,  -1.31753100e-01,
          -1.31110730e+00,   2.70644000e-01,   7.27090600e-01,
          -7.22309800e-01,  -1.03907010e+00,  -1.66550490e+00,
           1.59901000e-02,  -2.01713830e+00,  -1.32372480e+00,
          -1.38542050e+00,   3.37972700e-01,  -1.03586010e+00,
           1.21427570e+00,  -1.83696160e+00,  -1.82425530e+00,
          -1.01320700e+00,   1.29544510e+00,   1.64179900e-01,
           1.97075000e-02,  -1.23838620e+00,  -6.79401100e-01,
           9.25200000e-01,   4.91110000e-01,  -3.52135600e-01,
          -1.74090930e+00,  -1.87021900e-01,   1.49925800e-01,
           1.49162900e-01,  -2.32962350e+00,  -2.29326350e+00,
           2.09187500e-01,   5.60463600e-01,  -1.70538960e+00,
           2.84880000e-02,  -6.38066800e-01,  -2.21057380e+00,
           5.42614100e-01,   5.30851200e-01,  -1.06817750e+00,
          -3.07254000e-01],
        [ -2.14761660e+00,  -1.11981760e+00,  -3.45334030e+00,
           3.33732200e-01,   4.19781100e-01,  -8.44172300e-01,
           5.57252500e-01,   2.66454000e-02,  -1.35165570e+00,
          -4.44279900e-01,  -4.68413350e+00,  -1.82425530e+00,
          -5.15702600e-01,  -1.50561650e+00,  -8.34396500e-01,
          -1.05631700e-01,   4.38165700e-01,  -3.95507280e+00,
          -1.57452860e+00,   1.47979700e-01,  -9.31377600e-01,
           7.49644100e-01,  -1.30711910e+00,   9.91262400e-01,
          -1.28422980e+00,  -5.65435100e-01,  -9.97825800e-01,
          -1.66812220e+00,   3.64558600e-01,   7.90728300e-01,
           9.64200000e-03,  -2.30834490e+00,   6.75590000e-03,
           8.98438400e-01,  -2.25844930e+00,  -1.04725140e+00,
          -6.79779200e-01,   2.10218900e-01,   3.39655400e-01,
          -7.31618700e-01,   9.70896800e-01,   3.42455800e-01,
          -2.17336300e-01,  -2.30657000e-02,  -1.80072620e+00,
          -5.91529500e-01,   7.35437200e-01,   8.04486100e-01,
           1.71609130e+00,  -3.48578000e-01,  -4.84046200e-01,
           1.19965630e+00,   2.87457500e-01,  -1.41273150e+00,
           1.15905410e+00,  -3.23796400e-01,  -2.36095370e+00,
          -3.08259400e-01,   8.73817700e-01,  -2.36305700e-01,
           1.03902880e+00,  -3.71867900e-01,   1.31251590e+00,
          -9.42867300e-01,   3.91618500e-01,   4.83277300e-01,
          -1.22155370e+00,   4.04728900e-01,   5.68750600e-01,
          -8.62578300e-01,  -1.59808010e+00,   1.60157180e+00,
          -5.59483600e-01,  -1.23196340e+00,   2.13214900e-01,
          -4.71299400e-01,   4.69295700e-01,  -8.07196000e-01,
          -2.12504600e-01,  -1.74565280e+00,  -3.54384800e-01,
           7.03421500e-01,   4.37924500e-01,  -2.79904790e+00,
          -9.58250800e-01,  -2.61013680e+00,  -5.96896600e-01,
          -9.42867300e-01,  -9.51915400e-01,   1.08856740e+00,
          -2.69853030e+00,  -3.68639000e-01,   4.95354900e-01,
           6.07369800e-01,   7.62067600e-01,  -3.39071300e+00,
          -7.89128600e-01,  -3.07674600e-01,   6.47407300e-01,
          -8.85162300e-01],
        [  1.20913350e+00,  -5.62913500e-01,   1.04733800e-01,
          -1.15173350e+00,   1.08476080e+00,  -2.62614040e+00,
          -1.18782470e+00,  -3.02272580e+00,  -2.67938820e+00,
          -8.10932100e-01,  -4.39894300e-01,   1.57259100e-01,
          -1.50397560e+00,   2.55359300e-01,  -9.61909400e-01,
           1.86451480e+00,  -2.01713830e+00,   1.20811900e-01,
           3.93083500e-01,   1.27129800e-01,   6.57388000e-01,
           1.07448440e+00,   1.27849290e+00,  -5.76108000e-01,
          -6.64663000e-02,  -7.77670500e-01,  -1.87497770e+00,
           3.76499500e-01,  -4.62533500e-01,   9.80630100e-01,
           7.48656700e-01,   4.94636700e-01,  -1.88480680e+00,
           3.76499500e-01,  -2.17423100e-01,   7.41887000e-02,
          -7.87788700e-01,  -2.35915280e+00,   2.49625300e-01,
           2.28233400e-01,  -3.32001030e+00,  -5.54821200e-01,
           4.66778000e-01,  -1.38274480e+00,  -3.60334190e+00,
          -4.79832800e-01,  -7.05668800e-01,  -2.62050000e-02,
          -2.18393640e+00,   1.12471980e+00,  -4.87802300e-01,
          -1.92633240e+00,  -5.81745400e-01,  -9.41518000e-02,
          -6.63451000e-01,  -1.09113560e+00,  -1.03057300e-01,
           1.05452470e+00,  -1.11612070e+00,  -1.74799000e+00,
          -5.87986400e-01,   3.81964500e-01,  -3.87410800e-01,
           6.80328000e-02,  -2.75533500e-01,  -2.24293700e-01,
          -3.55770230e+00,  -7.77913000e-02,   7.01119900e-01,
          -1.31812450e+00,  -2.47336600e-01,  -2.43029810e+00,
          -1.71195940e+00,  -1.50118080e+00,   7.56090700e-01,
          -5.66852100e-01,  -3.30508800e-01,   8.59682800e-01,
          -1.98280790e+00,   1.59509780e+00,   1.51119900e-01,
          -9.33878400e-01,   1.16985800e-01,   2.01796800e-01,
           8.04599000e-02,   1.75519320e+00,   2.68110200e-01,
          -4.37662800e-01,   7.10018900e-01,   7.90728300e-01,
          -2.88075510e+00,  -4.76883700e-01,   5.69848400e-01,
          -7.77670500e-01,  -1.16813330e+00,  -7.25908800e-01,
           8.03487300e-01,   1.57089430e+00,   3.37505000e-01,
           7.19640100e-01],
        [ -5.39255000e-02,  -8.50216400e-01,   4.19968000e-01,
           1.12059530e+00,   5.89434500e-01,  -2.97619200e-01,
          -2.62190590e+00,   2.60721400e-01,  -1.23997940e+00,
          -2.18745840e+00,  -3.69969480e+00,   7.40730300e-01,
          -2.12249930e+00,  -1.70007060e+00,  -5.77349000e-01,
          -1.10658690e+00,  -2.19820500e-01,   4.41511100e-01,
          -6.66802300e-01,  -7.05668800e-01,  -3.23520830e+00,
          -2.68006680e+00,  -9.42723900e-01,   8.18623000e-01,
          -5.24858500e-01,  -3.02272580e+00,   2.60782300e-01,
          -6.79779200e-01,   5.98078900e-01,  -6.39962900e-01,
           9.80630100e-01,  -1.32833510e+00,   2.29064900e-01,
          -1.99040190e+00,  -3.05691030e+00,  -1.19880500e-01,
          -1.69400000e-03,   4.91110000e-01,  -4.36279500e-01,
          -8.08687500e-01,  -1.06811810e+00,  -1.07421180e+00,
          -5.55442550e+00,  -3.81473000e-01,  -6.04013400e-01,
           3.18825500e-01,   2.59955000e-01,  -2.05004660e+00,
          -6.39692600e-01,  -4.99962100e-01,  -3.45334030e+00,
          -2.45341500e-01,   7.84474700e-01,  -1.24255740e+00,
          -7.57453700e-01,   3.93083500e-01,  -9.77015000e-01,
           9.25200000e-01,  -9.44847100e-01,  -1.46048280e+00,
          -1.37330900e-01,   6.43209800e-01,   1.74691300e-01,
          -4.59581930e+00,  -6.40181100e-01,   4.62824500e-01,
          -3.07674600e-01,  -1.44916680e+00,  -5.80030300e-01,
          -2.69629740e+00,   3.66002600e-01,  -2.00270300e-01,
          -6.43843600e-01,   7.03756500e-01,  -5.32174400e-01,
          -5.32834700e-01,   7.82297200e-01,  -1.57452860e+00,
          -3.47215100e-01,   5.21221200e-01,   6.02640000e-02,
           1.73062000e-02,  -1.83919270e+00,  -7.12069100e-01,
          -1.12157270e+00,   5.16000000e-03,   9.52194500e-01,
          -1.59373080e+00,  -4.02770000e-02,  -2.83822960e+00,
           3.14348000e-02,   3.43366000e-01,  -6.94235100e-01,
          -6.98730200e-01,   7.80101500e-01,  -7.70469500e-01,
          -2.41950300e+00,  -1.19210450e+00,   2.59143000e-01,
          -4.18352800e-01]],

       [[ -1.68067120e+00,  -1.80776500e-01,  -3.67602330e+00,
           8.55906400e-01,   4.92955600e-01,  -2.61013680e+00,
          -7.89893000e-02,  -1.14472700e-01,   2.84880000e-02,
          -4.49571800e+00,   1.37529000e-01,  -8.02069900e-01,
          -9.22687100e-01,   1.64179900e-01,  -1.75561010e+00,
           6.64437200e-01,   4.19781100e-01,   4.82874200e-01,
           1.69242100e-01,  -5.33859300e-01,   1.25606000e-01,
          -2.99814200e-01,   3.13658700e-01,  -2.60453300e-01,
          -1.52900360e+00,   4.32548300e-01,  -6.43481000e-02,
           6.33698800e-01,  -2.18377960e+00,  -1.30612100e-01,
           6.44290200e-01,  -1.74368200e+00,  -7.57942500e-01,
          -4.17171000e-02,  -1.40845930e+00,  -1.81567350e+00,
           1.62121960e+00,   3.99112200e-01,   5.31384300e-01,
          -7.64929100e-01,  -3.93080780e+00,  -1.40356620e+00,
          -3.86239910e+00,  -2.31245130e+00,  -2.67938820e+00,
          -3.71867900e-01,   2.16561500e-01,  -2.71850500e-01,
          -5.82636000e-02,  -3.23796400e-01,   2.52760900e-01,
           9.98663400e-01,  -4.20164390e+00,  -1.26131080e+00,
          -3.05525750e+00,  -6.32415100e-01,   7.80435000e-01,
          -3.48578000e-01,  -1.69021500e-01,  -1.74145460e+00,
          -4.50354110e+00,  -4.20870420e+00,   8.58002500e-01,
          -2.86553290e+00,  -1.86826110e+00,  -1.49580310e+00,
          -2.87288980e+00,  -2.79593900e-01,  -2.14733490e+00,
          -4.76594190e+00,   5.25567400e-01,  -1.70538960e+00,
          -1.56900460e+00,   1.20192600e-01,  -2.24231730e+00,
          -9.79623200e-01,  -5.40890400e-01,   1.81290800e-01,
          -1.21283980e+00,   4.19968000e-01,  -2.46623430e+00,
          -2.57393300e-01,  -1.40315050e+00,   1.24534900e-01,
          -3.46953000e-02,  -1.34284160e+00,  -2.97767460e+00,
          -3.92712700e-01,   1.22395040e+00,  -9.37385700e-01,
           8.36624900e-01,   5.72785000e-02,   5.81220500e-01,
           4.22331100e-01,  -1.18789560e+00,  -8.09081600e-01,
          -1.41325790e+00,  -1.20079170e+00,  -2.15547360e+00,
          -6.98459000e-02],
        [  9.95000000e-04,  -3.25695900e+00,  -1.20676020e+00,
          -3.54473020e+00,   1.31678150e+00,  -9.85002000e-02,
           5.32529500e-01,  -1.76203710e+00,   1.20523450e+00,
          -1.67812410e+00,  -4.21065300e-01,  -1.96911560e+00,
           4.81826000e-01,  -1.14366360e+00,  -5.50353700e-01,
          -1.02472550e+00,  -2.17614820e+00,  -1.03790000e+00,
          -1.43630480e+00,  -1.57986570e+00,   3.14348000e-02,
          -2.61472920e+00,  -7.36552200e-01,   1.34789110e+00,
          -1.29480940e+00,   3.49692200e-01,   9.84047800e-01,
          -1.32938020e+00,  -2.17309000e-02,  -2.23759500e-01,
          -4.39894300e-01,   7.24331000e-01,   1.34470270e+00,
          -9.34687400e-01,  -2.29326350e+00,   1.04451620e+00,
          -4.42968100e-01,   2.94193000e-01,   1.31578120e+00,
          -1.79870800e-01,   4.74398400e-01,  -5.55442550e+00,
          -3.98929500e-01,  -1.51288630e+00,  -1.01756500e+00,
          -4.83009400e-01,  -8.81271400e-01,  -1.99307300e-01,
           3.03664000e-02,  -3.51588540e+00,  -1.71915280e+00,
           5.11387800e-01,  -9.84025000e-02,  -3.05666280e+00,
          -6.66375400e-01,  -2.55484480e+00,   5.31668800e-01,
           3.53958100e-01,  -9.37662100e-01,  -1.63518400e+00,
           8.35335800e-01,  -2.73362720e+00,  -4.52125900e-01,
           5.20000000e-02,  -4.20744700e-01,  -1.00921270e+00,
          -1.99637800e+00,  -7.32692000e-02,  -7.18877800e-01,
           9.59134000e-02,   1.38068500e-01,  -2.11760410e+00,
          -4.55223640e+00,  -9.70932500e-01,  -2.48186060e+00,
          -8.86072000e-02,  -1.15552320e+00,   1.80160000e-01,
          -6.77188200e-01,   1.86079000e-02,  -2.14761660e+00,
          -1.77694530e+00,   5.61515100e-01,  -2.52384480e+00,
           1.50038500e-01,  -1.07047120e+00,   7.06841500e-01,
          -1.66844820e+00,   4.92955600e-01,   1.08552130e+00,
          -6.16804400e+00,   3.53589300e-01,   9.54403000e-01,
          -3.80914700e+00,  -7.14505800e-01,  -1.37720660e+00,
           1.24438460e+00,  -1.86826110e+00,   5.64970800e-01,
           4.87782100e-01],
        [  1.70636500e-01,  -3.98857710e+00,   8.04486100e-01,
          -4.30000000e-01,  -2.49095000e-02,  -5.65070800e-01,
           6.44475600e-01,   2.27277500e-01,  -3.22006040e+00,
          -1.15346060e+00,  -8.67696900e-01,   1.39881300e-01,
          -1.75141240e+00,   9.42446000e-02,   2.35550200e-01,
           5.72618000e-01,  -5.09104900e-01,   1.75868300e-01,
           4.41511100e-01,  -3.31824740e+00,  -2.30427340e+00,
          -6.75831700e-01,   1.96316100e-01,  -1.49590870e+00,
          -1.82275290e+00,   1.70636500e-01,   1.49846520e+00,
           6.02600700e-01,  -6.13948900e-01,  -9.60418600e-01,
           1.12468500e-01,   1.54847200e-01,   1.51450490e+00,
          -1.69784160e+00,  -3.94438500e-01,   2.15192700e-01,
          -1.46295000e-01,   7.67837000e-02,  -8.35324300e-01,
          -5.42599900e-01,   6.12679800e-01,  -3.80636800e+00,
           4.36499000e-02,   9.89120000e-02,   3.53589300e-01,
           4.32393900e-01,  -4.29875300e-01,  -2.42141280e+00,
          -3.56875420e+00,  -9.99811400e-01,  -2.07797320e+00,
          -2.59213720e+00,  -6.83092100e-01,  -3.87410800e-01,
          -9.25414600e-01,  -2.53461080e+00,  -1.84671300e+00,
           9.25200000e-01,  -9.42723900e-01,  -7.40090400e-01,
           7.28711100e-01,  -1.70007060e+00,   8.93935500e-01,
          -4.95338600e-01,  -4.82258190e+00,   1.25113630e+00,
          -1.21702880e+00,  -1.24402710e+00,   1.12471980e+00,
          -1.91751300e-01,  -2.40340940e+00,   2.06852900e-01,
          -1.40541260e+00,  -5.77619000e-02,  -2.30548820e+00,
          -2.84554670e+00,   7.91725000e-02,   7.19640100e-01,
           1.41266200e-01,  -1.18782470e+00,   4.31910300e-01,
          -1.29020310e+00,  -2.07270160e+00,  -1.48545930e+00,
          -2.05427430e+00,  -2.40340940e+00,  -1.69724430e+00,
           3.37249200e-01,  -1.17984050e+00,   1.14225170e+00,
           1.30228300e+00,  -1.24851840e+00,  -2.64206660e+00,
          -2.03755770e+00,   1.01763510e+00,   8.18623000e-01,
          -1.19023580e+00,   1.21830000e-02,  -1.05946620e+00,
           1.00551220e+00],
        [ -1.62848000e+00,  -8.36456300e-01,  -1.96721200e-01,
          -9.51234100e-01,   6.34400400e-01,   5.64217600e-01,
          -1.59215720e+00,  -2.66740880e+00,  -2.62930400e+00,
           1.24438460e+00,  -2.11760410e+00,  -6.41159900e-01,
          -2.15752700e+00,   5.31038800e-01,  -2.42421100e-01,
          -9.63959800e-01,  -1.31835330e+00,  -1.13702360e+00,
           1.47486560e+00,  -2.49095000e-02,  -1.44036960e+00,
          -6.94939500e-01,  -1.62064560e+00,   3.60622600e-01,
          -1.93860800e-01,  -6.49039300e-01,   6.03380200e-01,
          -2.48411720e+00,  -5.77948200e-01,   1.30157480e+00,
          -3.02460510e+00,   2.53159200e-01,  -1.91996330e+00,
          -2.81768610e+00,  -4.32966700e-01,   6.01255500e-01,
          -1.01702300e-01,   1.02837710e+00,  -1.26384100e+00,
          -1.95576460e+00,   5.57588100e-01,  -4.56796110e+00,
           2.86759000e-01,  -1.43759500e-01,  -8.14588000e-01,
          -2.79634000e-01,  -1.25765600e-01,  -5.08729000e-01,
           1.04301040e+00,   7.72153900e-01,  -1.45988530e+00,
          -1.20691050e+00,   6.89695600e-01,  -1.55568680e+00,
          -2.39405450e+00,  -5.81745400e-01,  -6.24711000e-01,
          -1.28134600e-01,   4.36722600e-01,   1.65215400e-01,
          -2.88276700e-01,   2.90396900e-01,  -4.24638700e-01,
           5.88469800e-01,  -3.00930000e-01,   4.36499000e-02,
          -1.11503660e+00,   4.87782100e-01,   1.10606470e+00,
          -4.26240000e-01,  -8.14737800e-01,   1.43399360e+00,
          -8.02069900e-01,  -1.12273670e+00,   4.69295700e-01,
           6.24981600e-01,  -1.73372890e+00,  -2.87737930e+00,
           3.51548300e-01,   2.59450100e-01,  -5.64856880e+00,
           2.87457500e-01,   3.66002600e-01,   1.83318700e-01,
           3.01021900e-01,  -3.13692200e+00,  -6.83092100e-01,
          -1.07570210e+00,  -1.96620000e-02,  -1.93469800e-01,
          -4.30757900e-01,  -5.59940000e-02,  -1.23903600e+00,
          -2.30834490e+00,  -3.41109300e-01,  -1.17530980e+00,
          -1.23086970e+00,  -2.02416400e-01,  -5.06028000e-01,
           3.25909100e-01],
        [  7.72983300e-01,  -1.56492910e+00,   7.52033000e-01,
           2.13101900e-01,  -1.14366360e+00,   8.88287700e-01,
           4.22570000e-02,  -1.52273780e+00,   4.87782100e-01,
          -2.42141280e+00,   1.73889700e-01,   2.59450100e-01,
           2.18025900e-01,   1.30481020e+00,   5.69496000e-02,
          -8.58809300e-01,  -5.22574400e-01,  -3.46423680e+00,
           4.63233900e-01,   2.24281600e-01,   1.65134600e-01,
           6.86769900e-01,   3.58959800e-01,  -2.90877420e+00,
          -1.09094560e+00,  -2.70075300e-01,   3.33732200e-01,
          -4.30313750e+00,  -2.23572500e-01,  -2.67267330e+00,
          -8.76174300e-01,  -9.31377600e-01,  -9.91477200e-01,
          -5.74530600e-01,  -9.74117300e-01,   4.95354900e-01,
          -4.22931000e-02,  -1.16026340e+00,  -1.93426220e+00,
           8.37761500e-01,  -1.35535680e+00,   4.88659000e-01,
          -1.09590390e+00,  -2.18087000e-01,  -2.12621600e-01,
          -2.61242160e+00,  -7.37970800e-01,  -9.27135300e-01,
          -1.51110000e-02,  -4.75581200e-01,   1.02463600e-01,
          -4.57134780e+00,   2.54741800e-01,  -6.69983000e-01,
          -1.96721200e-01,  -3.56614600e-01,   9.86625500e-01,
           9.20689800e-01,  -3.46342500e+00,  -2.26862700e+00,
           9.97241100e-01,   2.34304000e-01,  -9.40838300e-01,
           3.99100000e-01,  -6.27466300e-01,   1.16468000e-02,
          -2.35411540e+00,  -2.34414400e-01,   6.17825400e-01,
          -2.83822960e+00,  -2.34395900e-01,  -1.49318750e+00,
          -1.68435000e-02,  -1.43759500e-01,  -2.20538600e-01,
          -2.79634000e-01,   9.20689800e-01,  -1.27319850e+00,
          -1.41646900e-01,  -6.37483700e-01,  -9.96707900e-01,
          -8.02069900e-01,   2.92928000e-02,  -1.30912100e-01,
          -9.69728200e-01,   6.99169200e-01,  -1.30466830e+00,
          -2.52545850e+00,   4.56431000e-02,   4.90855100e-01,
           2.51477700e-01,  -4.56796110e+00,  -1.94369100e-01,
          -1.86334630e+00,   9.70069400e-01,  -4.49584800e-01,
           1.95969000e-01,   8.87870700e-01,  -1.37877040e+00,
          -2.83750600e-01]]])

    # Variables choice model
    dict['AT_FSP'] = 10
    dict['TD_FSP'] = 10
    dict['Origin'] = np.array([0, 1, 1, 0, 0])
    dict['AT_PSP'] = 10
    dict['TD_PSP'] = 10
    dict['AT_PUP'] = 5
    dict['TD_PUP'] = 10
    dict['Age_veh'] = np.array([0, 0, 0, 1, 0])
    dict['Low_inc'] = np.array([1, 1, 1, 1, 0])
    dict['Res'] = np.array([1, 1, 1, 0, 1])

    return dict

def preprocess(dict):
    ''' Precomputation on the data in order to create the corresponding
        cplex model.
    '''

    ########## Precomputation ##########
    # Priority list
    priority_list = np.empty([dict['I'] + 1, dict['N']])
    for i in range(dict['I'] + 1):
        min = 1
        max = dict['N']
        for n in range(dict['N']):
            if dict['choice_set'][i, n] == 1:
                priority_list[i, n] = min
                min += 1
            else:
                priority_list[i, n] = max
                min -= 1
    dict['priority_list'] = priority_list

    # Exogene utility
    exo_utility = np.empty([dict['I'] + 1, dict['N']])
    for n in range(dict['N']):
        for i in range(dict['I'] + 1):
            if i == 0:
                # Opt-Out
                exo_utility[i, n] = (dict['Beta_AT'] * dict['AT_FSP'] +
                                       dict['Beta_TD'] * dict['TD_FSP'] +
                                       dict['Beta_Origin'] * dict['Origin'][n])
            elif i == 1:
                # PSP
                exo_utility[i, n] = (dict['ASC_PSP'] +
                                       dict['Beta_AT'] * dict['AT_PSP'] +
                                       dict['Beta_TD'] * dict['TD_PSP'])
            else:
                # PUP
                exo_utility[i, n] = (dict['ASC_PUP'] +
                                       dict['Beta_AT'] * dict['AT_PUP'] +
                                       dict['Beta_TD'] * dict['TD_PUP'] +
                                       dict['Beta_Age_Veh'] * dict['Age_veh'][n])
    dict['exo_utility'] = exo_utility

    # Beta coefficient for endogenous variables
    beta_FEE_PSP = np.empty([dict['N']])
    beta_FEE_PUP = np.empty([dict['N']])
    for n in range(dict['N']):
        beta_FEE_PSP[n] = (dict['Beta_FEE'] +
                             dict['Beta_FEE_INC_PSP'] * dict['Low_inc'][n] +
                             dict['Beta_FEE_RES_PSP'] * dict['Res'][n])
        beta_FEE_PUP[n] = (dict['Beta_FEE'] +
                             dict['Beta_FEE_INC_PUP'] * dict['Low_inc'][n] +
                             dict['Beta_FEE_RES_PUP'] * dict['Res'][n])
    dict['endo_coef'] = np.array([np.zeros([dict['N']]), beta_FEE_PSP, beta_FEE_PUP])

    # Calculate bounds on the utility
    lb_U = np.empty([dict['I'] + 1, dict['N'], dict['R']])
    ub_U = np.empty([dict['I'] + 1, dict['N'], dict['R']])
    lb_Umin = np.full((dict['N'], dict['R']), np.inf)
    ub_Umax = np.full((dict['N'], dict['R']), -np.inf)
    M = np.empty([dict['N'], dict['R']])
    for n in range(dict['N']):
        for r in range(dict['R']):
            for i in range(dict['I'] + 1):
                    if dict['endo_coef'][i, n] > 0:
                        lb_U[i, n, r] = (dict['endo_coef'][i, n] * dict['lb_p'][i] +
                                        dict['exo_utility'][i, n] + dict['xi'][i, n, r])
                        ub_U[i, n, r] = (dict['endo_coef'][i, n] * dict['ub_p'][i] +
                                        dict['exo_utility'][i, n] + dict['xi'][i, n, r])
                    else:
                        lb_U[i, n, r] = (dict['endo_coef'][i, n] * dict['ub_p'][i] +
                                        dict['exo_utility'][i, n] + dict['xi'][i, n, r])
                        ub_U[i, n, r] = (dict['endo_coef'][i, n] * dict['lb_p'][i] +
                                        dict['exo_utility'][i, n] + dict['xi'][i, n, r])
                    # Bound for each customer, for each draw
                    if lb_U[i, n, r] < lb_Umin[n, r]:
                        lb_Umin[n, r] = lb_U[i, n, r]
                    if ub_U[i, n, r] > ub_Umax[n, r]:
                        ub_Umax[n, r] = ub_U[i, n, r]

            # Calcule the big-M values
            M[n, r] = ub_Umax[n, r] - lb_Umin[n, r]
    dict['lb_U'] = lb_U
    dict['ub_U'] = ub_U
    dict['lb_Umin'] = lb_Umin
    dict['ub_Umax'] = ub_Umax
    dict['M'] = M

if __name__ == '__main__':
    dict = getData()
    preprocess(dict)

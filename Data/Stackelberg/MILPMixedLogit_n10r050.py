# Data Stackelberg game with capacity, continuous price
import numpy as np

def getData():
    ''' Construct a dictionary containing all the data_file
        Returns:
            dict          dictionarry containing all the data
    '''
    # Initialize the output dictionary
    dict = {}

    # Number of alternatives in the choice set (without considering opt-out)
    dict['I'] = 2

    # Number of customers
    dict['N'] = 10

    # Number of draws
    dict['R'] = 50

    # Lower and upper bound on prices
    dict['lb_p'] = np.array([0, 0.00, 0.00]) # lower bound (FSP, PSP, PUP)
    dict['ub_p'] = np.array([0, 1.00, 1.00]) # upper bound (FSP, PSP, PUP)

    dict['capacity'] = np.array([60.0, 6.0, 6.0]) # Availability for each alternative (opt-out always available)

    #dict['fixed_cost'] = [0.0, 1.0, 1.0] # Initial cost for each alternative
    #dict['customer_cost'] = [0.1, 0.1, 0.1] # Additional cost for each new customer

    # Choice set of the customers
    #	 		           n1 n2 n3...
    dict['choice_set'] = np.array([[1, 1, 1, 1, 1, 1, 1, 1, 1, 1],  # OPT-OUT
                       			  [1, 1, 1, 1, 1, 1, 1, 1, 1, 1],  # PSP
                    	 		  [1, 1, 1, 1, 1, 1, 1, 1, 1, 1]])  # PUP

    # Parameters choice model
    dict['ASC_PSP'] = 32
    dict['ASC_PUP'] = 34
    dict['Beta_TD'] = -0.612
    dict['Beta_Origin'] = -5.762
    dict['Beta_Age_Veh'] = 4.037
    dict['Beta_FEE_INC_PSP'] = -10.995
    dict['Beta_FEE_RES_PSP'] = -11.440
    dict['Beta_FEE_INC_PUP'] = -13.729
    dict['Beta_FEE_RES_PUP'] = -10.668

    # AT coefficient
    dict['Beta_AT'] = np.array([[-1.21265711e+00, -8.84159170e-01,  6.04289002e-01,
        -3.76388980e+00, -1.10858366e+00,  8.44117085e-01,
        -1.76918520e+00, -8.92960465e-01,  8.44830025e-02,
        -7.35708486e-01, -1.42370547e+00, -6.82185643e-01,
        -2.11679836e-01, -8.12802462e-01, -2.17428976e+00,
        -2.41734831e+00, -9.11732429e-01, -6.08273235e-01,
        -1.76639284e+00,  2.30932242e-01,  2.61123788e-02,
         1.37497717e+00, -1.26728519e+00, -2.60919756e-01,
         1.18424379e+00,  2.31579572e-01,  8.50364162e-01,
        -4.16907384e-01, -1.11878089e+00, -6.22557122e-01,
        -4.42131319e-01, -1.71815718e+00, -9.86952103e-01,
        -3.28300999e-01, -1.80968123e+00,  1.57048332e+00,
        -2.26840508e+00, -8.04812385e-01,  3.73001695e-01,
         1.83048098e+00,  7.93435362e-01,  6.48746828e-01,
        -2.02766156e+00, -1.68368375e+00, -1.60276409e+00,
         4.86577812e-01, -1.27875741e-01,  2.17923832e-02,
        -4.81826068e-01, -1.80814875e-01],
       [-1.45773895e+00, -2.47189749e+00, -1.23703954e+00,
        -1.86651051e+00, -3.76321530e-01,  3.18942488e-01,
        -7.35187453e-01, -4.64212660e-01, -2.41282070e+00,
         5.43067806e-01, -4.47967628e-01, -3.90535215e-01,
        -9.83229530e-03, -8.76504247e-01, -1.46621794e+00,
        -7.90704432e-01,  4.42686647e-01, -8.92124563e-01,
        -2.11332202e+00, -2.56091625e+00, -2.54775906e+00,
        -8.13037853e-01,  2.04458504e-01, -1.10068708e+00,
        -8.38414478e-01,  7.21444332e-01, -5.34366981e-01,
        -8.18517549e-01, -1.48399674e+00, -6.88622031e-01,
        -2.16625454e+00, -8.70683935e-02,  5.73018778e-02,
        -6.45513509e-01, -1.52214282e+00,  2.33903065e-01,
        -9.80694314e-01,  1.67868973e+00, -1.88288903e+00,
        -1.69959498e+00, -1.17175294e+00, -1.55937351e+00,
        -5.99537183e-01, -1.06893810e-03, -1.93718847e+00,
        -8.33106122e-01,  1.02217483e+00, -1.15415070e+00,
        -1.36743437e+00,  6.72046520e-01],
       [-2.34639238e+00, -2.67061178e+00, -4.81289381e-01,
        -1.09199307e-01,  4.35754212e-01, -6.51889550e-01,
        -7.40328553e-01,  1.93918034e+00, -1.45668537e+00,
        -1.04493378e+00, -1.09709187e+00, -6.96397865e-01,
         1.42105386e+00, -8.79458670e-01, -1.07781942e+00,
         7.87195744e-01, -6.48851263e-01, -7.96778372e-01,
         2.22121966e+00, -8.54970280e-01, -1.81377869e+00,
         1.04422533e+00, -1.52963130e+00, -8.38045362e-01,
         1.04592291e+00,  6.03217333e-01, -9.63957914e-01,
        -6.55019444e-01, -1.24965108e+00, -1.74305559e+00,
         1.97235341e-01,  4.36208283e-01,  5.83455940e-01,
        -1.79854311e+00, -2.83146475e-01, -1.07623590e+00,
        -5.55007473e-01, -3.17285571e-01, -4.04915073e-01,
         1.42793606e+00, -1.56311505e+00,  6.26868702e-01,
         3.90037493e-01, -2.33643086e+00,  6.05563331e-01,
        -4.34989806e-01,  2.81817156e+00, -9.36978993e-01,
        -2.30629403e+00,  1.93811978e+00],
       [-3.18035793e+00, -8.64094929e-01, -4.54989321e-01,
        -1.35942833e+00, -3.77400992e-01, -2.37241453e+00,
        -1.61961892e+00, -2.03925183e+00, -1.98233749e+00,
         1.61046425e-01, -1.47307612e+00, -1.09195357e+00,
        -1.48028966e-01, -2.32493645e+00,  5.83679764e-01,
        -5.25042770e-03, -6.69473090e-03, -9.52033595e-01,
        -1.59602033e+00, -1.04959245e+00, -2.69152254e-01,
        -4.39699726e-01,  8.51114363e-01, -6.78082914e-01,
        -2.93464364e+00, -9.40858475e-01, -9.13518609e-01,
        -6.46495137e-02,  2.57011165e+00, -2.60912500e-01,
        -1.73223743e+00,  8.76835039e-01,  3.30006298e-01,
        -2.11561821e+00, -9.67878079e-01, -1.98010353e+00,
        -1.49787902e+00, -1.39696608e+00,  1.08036759e-01,
        -1.53228527e+00,  5.71546716e-01, -4.07346811e-01,
        -7.15721493e-01, -3.87288660e-01, -4.31342215e-01,
         9.10025921e-01,  3.25360276e-01, -5.25607849e-01,
         8.43072077e-02, -9.73785987e-01],
       [-7.48363945e-01, -2.50198330e+00, -1.52811937e+00,
        -2.02954978e+00,  1.44644527e-01, -2.42797910e+00,
        -1.34003132e+00,  2.63949529e-01, -3.33396578e+00,
        -1.34057801e+00, -7.22218912e-01, -2.10176249e+00,
        -2.24280958e+00, -1.11671646e+00,  6.47738308e-01,
        -1.90647389e+00,  2.47939540e-01, -2.87935737e+00,
        -6.58300443e-01, -7.76227407e-01, -1.08671797e+00,
        -1.10034165e+00, -8.21408466e-01, -1.35317590e+00,
         4.08811567e-01, -1.23555489e+00, -7.63585732e-01,
        -3.05111207e-01, -1.12457571e+00, -1.03321819e+00,
         1.85804590e-01,  8.32328507e-01,  6.34629699e-01,
         2.80534617e-02, -1.23459935e+00, -5.67720234e-01,
        -3.43622342e-01, -2.17831565e+00, -7.30304511e-01,
        -1.08838427e+00,  5.13004853e-02,  2.07312343e-01,
        -1.33947069e+00, -1.40330777e-01, -2.53383848e+00,
        -6.16975060e-01,  2.66997268e-01, -5.58376316e-01,
        -1.17318474e+00,  8.82648870e-03],
       [ 1.02183777e+00, -7.22214687e-01,  6.49857324e-01,
        -2.26337542e-01, -1.61861912e+00, -4.07071485e-01,
        -1.63585085e+00,  4.30211094e-01,  9.80674752e-02,
        -2.33820333e+00, -1.93081674e+00, -6.39346676e-01,
         3.21505357e-01, -1.31253754e+00, -4.67611718e-01,
        -1.06472891e+00, -2.52644378e+00, -2.50962921e+00,
         1.00175769e-01, -1.31018730e+00, -1.46583824e+00,
        -1.96636604e-01,  4.92554724e-01, -8.95536349e-01,
        -2.37217905e-01, -1.67963080e+00,  4.39770987e-01,
        -1.17770812e+00, -2.09476605e+00, -1.57359190e+00,
        -3.71742307e-01, -1.09032274e+00,  1.33932348e-01,
        -1.20378138e-01, -2.30882235e+00,  8.76272938e-01,
        -1.85523637e+00, -1.60670355e+00, -9.12392719e-01,
        -2.37850689e+00, -1.25679761e+00, -4.48995077e-01,
        -5.60547221e-01, -6.62908761e-01, -1.42013017e+00,
         3.49049332e-01, -4.95184969e-01, -1.33478689e-01,
        -1.84776800e+00, -9.14232254e-01],
       [-4.22543254e-01, -2.24241298e+00, -1.05865319e+00,
        -6.82508467e-01, -6.75073920e-01,  9.98712319e-02,
        -1.41533790e+00,  1.50765306e-01,  1.32129932e-01,
        -4.24168380e-01, -1.61988566e+00, -7.49339237e-02,
        -1.85458329e+00, -8.47224835e-01, -1.48608236e+00,
        -1.29776069e+00, -2.38076613e+00, -2.00494189e+00,
         1.70047990e+00, -3.20880955e-01, -6.48212883e-01,
        -2.72927385e-01, -2.52429839e+00, -8.26027847e-01,
        -1.19057623e+00, -1.56465218e+00, -1.60868378e+00,
         3.03197385e-02, -1.26508070e+00, -1.17660501e+00,
        -6.56262384e-01, -1.36960370e+00, -1.66282326e+00,
        -1.80846322e+00, -9.03554041e-01, -3.37825361e-01,
        -1.47851245e+00,  4.37476962e-02, -5.18386756e-01,
         7.35503702e-01, -6.20280680e-01, -3.05244123e-01,
        -2.54455144e+00,  1.01797643e+00,  5.50529440e-01,
        -6.33468167e-01, -5.50532802e-01, -1.85837016e+00,
         1.36340833e-01, -9.02977356e-02],
       [-1.15698671e+00, -6.67534347e-01, -2.86748533e+00,
        -6.48672958e-01, -7.93103325e-01, -1.36570338e+00,
        -8.85531652e-01, -2.20929954e-01,  7.06465942e-01,
        -2.08019989e+00,  8.58204618e-01,  6.20607858e-01,
         2.53860458e-01, -3.55436307e-01, -7.57520630e-03,
        -6.75840649e-01, -1.03997325e-01, -3.69894568e-01,
         1.74008718e+00, -5.65940023e-01, -1.97235036e-01,
         7.96781076e-01,  4.62236567e-01, -3.34616062e-01,
        -3.45334525e+00, -1.29546797e+00, -1.77393407e+00,
         9.23697363e-01, -6.30605870e-01, -2.79017349e+00,
        -1.40466796e+00, -9.44140643e-01,  8.28457644e-01,
        -1.55932210e+00,  6.12151001e-01, -3.99244913e-01,
        -2.08702170e+00, -1.43453032e+00, -7.79901423e-01,
        -1.60232209e-01, -3.31730755e+00, -4.43923428e-01,
        -1.68981518e+00,  9.31497278e-01, -1.57133512e+00,
        -2.31093551e+00, -1.44422414e-01, -4.27655312e-01,
        -6.47459808e-01, -1.37933244e-01],
       [-1.65185600e+00, -3.12925511e+00, -1.34613017e+00,
        -8.32474541e-01, -3.96684293e+00, -5.86516774e-01,
        -1.41728443e+00,  4.34878849e-01, -7.36866982e-01,
        -9.66503736e-01, -1.05789179e+00, -4.12222640e-01,
        -2.08125338e+00, -1.66480192e+00,  7.93265063e-01,
        -1.10207977e+00, -2.05589815e+00, -1.16027899e+00,
        -1.61208803e+00, -1.09801269e+00, -2.30222303e-01,
        -5.11369286e-01,  6.51176809e-01, -6.65485660e-01,
        -2.00712514e+00, -6.55844541e-01, -1.01865593e-01,
        -1.51999850e+00,  8.09910403e-01,  2.50425071e+00,
        -2.62964505e+00,  8.04558201e-01, -2.37747434e+00,
         8.61330254e-01, -1.35308705e-01, -7.49288288e-01,
        -1.62749977e-01,  1.35135517e+00, -1.23846935e-01,
         1.24134031e+00, -3.59438926e+00, -1.18378351e+00,
        -1.17169117e+00, -2.55056689e+00, -4.30181165e-01,
        -4.53673651e-01, -4.15733223e-01, -2.38076613e+00,
         1.09526943e+00,  2.09220702e-01],
       [-1.99658145e+00, -1.77412524e+00, -4.02349770e-01,
        -1.35326242e+00,  7.30338976e-01, -1.06680132e+00,
        -5.01755164e-01,  4.20417199e-01, -9.84871027e-01,
        -5.82079203e-01, -7.48322989e-01, -2.16065002e+00,
        -4.17394937e-01, -9.59449782e-01, -1.30280333e+00,
        -1.31828918e+00, -1.40848976e+00,  6.19093536e-01,
         2.25511833e-01,  1.01023225e-01, -1.15520492e+00,
        -5.39491044e-02, -5.56841563e-01, -1.49142237e+00,
        -4.20400293e-01, -8.15746798e-01, -2.11231862e+00,
         2.35325525e-01, -2.06028713e+00, -3.09151091e+00,
        -1.37158652e+00, -7.95181184e-01,  1.00944689e+00,
        -7.92711311e-01,  2.87611545e-01, -5.67482389e-01,
        -7.70805816e-01, -1.33435108e+00,  1.37245135e-01,
         4.35459819e-01, -2.79093741e+00,  1.36669324e+00,
        -1.90185996e+00, -7.22975990e-01,  1.10628753e+00,
        -1.95586951e-01, -6.97562092e-01, -7.48709938e-01,
        -2.63713694e+00,  4.16611132e-01]])

    # FEE coefficient
    dict['Beta_FEE'] = np.array([[-39.83560079, -16.94117855, -23.76145154, -24.34083586,
        -41.75064079,  -9.4776606 , -31.60358186, -38.20034445,
        -21.58399663, -30.5944229 , -23.64176604, -55.89585902,
        -35.86307643, -31.44994363, -56.15081617, -25.07096393,
        -14.02148361, -31.45192574, -30.26871728, -64.66114708,
          1.3668559 , -56.45299941, -22.65173612, -40.75969621,
        -10.12573348, -16.58018338,  -0.50619224, -65.11792198,
        -23.18252514, -30.02883055, -40.17365083, -25.25853594,
        -25.95959852, -54.08000753, -12.5188757 , -23.81615323,
        -11.44854621, -44.14667676, -29.97295332, -16.9103805 ,
        -39.12075286, -11.69830663, -17.21122893, -40.12131114,
        -36.1251483 , -34.36989354, -32.29217951, -45.39078348,
        -16.81954759, -17.89822437],
       [-51.33668444, -28.93417448, -48.52435903, -35.49997114,
        -18.79490003, -41.41091211, -30.6882344 , -41.05833764,
        -33.2360945 , -53.84445497, -42.99795219, -29.98382757,
        -33.0306463 , -36.96317668, -21.10192282, -31.20121788,
        -33.33811721, -31.1275882 , -48.60725116, -40.07457369,
        -24.10028199, -21.15769313, -23.42514787, -56.08445731,
        -62.03377729, -23.62076222, -61.07644331, -29.79097317,
        -36.67478744, -18.98301554, -45.04319722, -42.79178665,
        -28.29798358, -32.96695564, -30.99282598, -24.36916338,
        -43.31882199, -32.67105715, -48.21759076, -28.56495259,
        -11.14112345, -27.12481005, -26.52522453, -31.04138758,
        -50.15635497, -22.99071647, -14.40019036, -40.69313899,
        -36.58360298, -18.20144444],
       [-29.21429311, -33.08988005, -35.47058866, -23.89971232,
        -24.08911354,  -9.95472119, -51.88735144, -30.46486271,
        -41.06400689, -37.21699374, -21.75205781, -46.26353999,
        -51.87243921,  -7.83219693, -29.43727702, -55.19288441,
        -11.89163774, -50.48272434, -42.88561076, -29.64279732,
        -35.98452318, -31.12744907,  -7.05877244, -15.85594347,
        -28.69501292, -49.50244368,  -6.54717263, -28.47349218,
        -43.21594056, -21.31200798, -23.94625708, -33.10136756,
        -48.66709623, -27.52203072, -29.72493018, -23.96721029,
        -25.46003121, -46.89946873, -25.53644979, -42.14872554,
        -25.68687429, -32.86727759, -53.43390282, -36.68718808,
        -45.67345491, -24.39412123, -22.65181826, -20.97916275,
        -25.41015698, -36.04369186],
       [-40.03660508, -52.287648  , -23.1921887 , -35.04227607,
        -71.59042439, -26.37407968, -39.35260549,  -5.12369135,
        -32.13504133, -37.21365635, -24.81687211, -62.5966589 ,
         -8.24052373, -17.64575818, -48.30224082,  -2.56316456,
        -20.7945125 , -39.51358881, -31.08444632, -28.71551948,
        -40.88509205, -51.42544509, -68.45941388, -25.16561837,
        -19.85917194, -22.73663011, -42.47801913, -43.1512083 ,
        -38.00904317, -31.60309304, -43.43519658, -20.63401229,
        -26.04131342, -14.07215232, -34.92186489, -22.85320213,
        -36.0741473 , -26.92099733, -40.77343982, -43.63197606,
        -14.47192498, -39.10532526, -39.72113524, -32.06106149,
        -40.15134377, -35.63695288, -39.63701636, -21.84820215,
        -24.6949567 , -54.40364827],
       [-37.18393771, -49.60575185, -32.08064059, -29.76779111,
        -47.68259678, -15.99971138, -51.50210642, -45.74839927,
        -40.30104515, -31.73285857, -24.27827165, -37.35413775,
        -35.21203283, -45.37099092, -24.31671309, -42.91603666,
        -48.04571025, -17.50954142, -35.14468411, -13.29407666,
        -43.58680829, -13.33633093, -41.24463569, -10.01276495,
        -42.74257039, -10.36982737, -32.37507372, -54.14090791,
        -22.85666571, -21.35294193, -28.02699329, -57.93424236,
        -12.54710603, -38.46204428, -26.08020384, -12.57371097,
        -20.67955807, -45.86414173, -24.51114822, -25.70494987,
        -38.8280387 , -36.53985693, -60.58962029, -36.74353099,
        -30.02208306, -12.11616185, -33.95366901, -38.07411293,
        -21.29306766, -52.301526  ],
       [-26.19352183, -40.2987704 , -22.72626072, -46.44007914,
        -24.97141838, -42.8169232 , -20.16438288, -42.05073669,
        -28.57474521, -28.00834215, -39.72466634, -33.73100992,
        -41.12991894, -41.20581411, -31.47243791, -32.58986741,
        -51.65293003, -46.90493133, -46.41197554, -43.69882682,
        -37.23844036, -16.98337937,  -8.3076413 , -63.22867343,
        -30.87778089, -66.67197569, -23.33858979, -38.56298914,
        -32.11568325, -23.16968726, -24.37330265, -53.41798101,
        -50.73822639, -38.10856015, -26.2780254 , -35.03391547,
        -15.38986015, -12.92180293, -18.69591246,  -0.20619074,
        -15.76476505, -29.50041057, -34.79168303, -39.78726247,
        -24.56496791, -24.12630688, -30.11722435, -24.73871966,
        -41.83891553, -53.01712617],
       [-44.64120999, -24.24407432, -30.48465561, -22.98025345,
        -25.18552365,   6.47400246, -49.00646798, -44.62510323,
        -26.66521138, -34.53302642, -22.83386456, -48.97772515,
        -32.52646932, -26.95541975,  -4.47683356, -48.20135305,
        -35.52293925, -13.44335667, -26.94936739, -30.33193664,
        -44.48194578, -33.34365942, -40.01566063, -25.42989885,
        -38.35346676, -42.34710547, -36.07148138, -16.39989448,
        -33.02502073, -31.2015145 , -24.07350129, -13.96996209,
        -19.52300021, -33.23937227, -33.97931579, -26.09628929,
        -53.52975093, -36.74129193, -42.25683574, -47.90311385,
        -26.26496904, -40.48081166, -22.85376613,  -2.71225485,
        -38.77761819, -15.9293457 , -33.4037235 , -42.81407559,
        -44.53138461, -43.33330145],
       [-64.19619599, -34.29267073, -37.63413479, -20.24632787,
        -20.45966352, -42.52196967,  12.27953107, -52.21019738,
        -52.44419879, -15.69655562, -22.85439971, -28.16066326,
        -38.05295961,  -8.53339857, -43.47563674, -55.31693221,
        -50.18418019, -28.96465133, -10.6943167 , -35.28599189,
        -38.20913134, -31.92389473, -26.64750136, -29.91580483,
        -35.17454877, -22.38816716, -22.3738534 , -35.68888418,
        -22.52468867, -33.99831683, -60.62972848, -32.25544238,
        -18.74384143, -20.66115576, -28.49135835, -43.32947851,
        -58.26437322, -12.66358646, -30.97559409, -22.31391731,
        -20.81669023, -37.40167233, -13.58425845, -12.36915532,
        -39.78188181, -38.52797534, -35.95206886, -26.45038376,
        -28.03055119, -29.86726893],
       [-45.3005698 , -21.25503591, -16.27499248, -30.9110434 ,
        -21.69552209, -31.74397575, -29.44509075, -15.24290996,
        -27.16105745, -47.98397508, -21.52511617, -20.68546629,
        -43.96296974, -40.66290461, -41.50305766, -44.12473528,
        -12.69220146, -24.89443967, -46.29598055, -20.38446348,
        -39.07435004,  -7.21084993, -33.51559063, -29.2958537 ,
        -19.94387457, -47.53604229, -56.75288019, -28.98684276,
        -38.93791336, -51.33467628, -26.21468348, -37.84726775,
        -35.71880198, -29.04114347, -18.48486938, -32.92099032,
        -37.60723528, -34.71145423, -40.18039281,  -4.73745553,
         -9.27856386,  -5.71586905, -24.03850676, -33.00862365,
        -26.5093641 , -35.56903289, -19.42573647, -42.63750155,
        -45.62673318, -32.1110443 ],
       [-34.29983452, -32.08428754, -49.64174436,  -0.35890674,
        -24.73910335, -37.60334598, -11.56237582, -50.62635873,
        -45.93605896, -26.54715774, -37.6867621 , -52.61771391,
        -12.62952885, -25.40655615, -28.00134726, -38.47136173,
        -47.48531019, -16.40459182, -45.92929586, -30.80276274,
        -25.93663457, -28.20165999, -19.00631339, -36.37991246,
        -25.04179083, -32.05024904, -32.25985773, -38.34537153,
        -39.47538089, -29.32747665, -40.95679181, -25.86880022,
        -51.24479094, -52.53103772, -40.00164506, -22.34895038,
        -25.92108583, -28.64494295, -31.76246267, -50.62536239,
        -15.39407696, -36.73229951, -42.49032492, -27.23314502,
        -29.169601  , -35.62707372, -38.52464496, -35.02258694,
        -29.75735332,  -2.47511274]])

    # Random term (Gumbel distribution (0,1)) - 3 alternatives x 10 customers x 50 draws
    dict['xi'] = np.array([[[  3.00777300e-01,  -1.11404900e+00,  -2.72564000e-02,
          -8.46871000e-01,   3.47582600e-01,  -4.22376600e-01,
          -7.22018000e-01,   1.48181400e-01,  -5.39255000e-02,
           7.58866900e-01,  -1.07926230e+00,  -1.18193700e+00,
          -1.17551500e+00,  -2.05004660e+00,  -1.45473300e-01,
          -5.52281500e-01,  -1.34856760e+00,  -2.32702240e+00,
          -7.47981300e-01,   9.46382900e-01,  -3.63967810e+00,
          -8.40901800e-01,  -4.13138800e-01,  -1.35165570e+00,
          -2.96777770e+00,  -9.31377600e-01,   1.23366320e+00,
           6.01065800e-01,  -4.05693800e-01,   1.06373310e+00,
           5.81783100e-01,  -4.22376600e-01,  -3.88671200e-01,
          -5.85119900e-01,  -2.54762740e+00,  -6.79779200e-01,
           1.30803440e+00,  -1.37512600e-01,  -2.40340940e+00,
          -5.62913500e-01,  -1.20676020e+00,  -1.96066700e-01,
           3.12711000e-02,   4.44850400e-01,   4.91462900e-01,
           3.50650300e-01,  -2.22350000e-02,   8.91549900e-01,
          -1.59373080e+00,   3.15500300e-01],
        [ -5.54569500e-01,   6.46320900e-01,   7.41887000e-02,
          -9.75405000e-01,  -7.57942500e-01,  -1.29020310e+00,
           5.72785000e-02,   2.24281600e-01,  -1.28237270e+00,
          -3.51545300e-01,   2.13101900e-01,  -2.17614820e+00,
          -1.78637100e-01,   1.67338700e-01,  -8.60508000e-02,
          -1.04495920e+00,  -7.50947600e-01,   6.89610300e-01,
           4.81380500e-01,  -3.95621800e-01,   8.16803900e-01,
          -1.18792280e+00,   6.40921400e-01,   2.60808900e-01,
          -2.30427340e+00,  -2.71477750e+00,   7.98925500e-01,
           6.56647100e-01,  -1.16359920e+00,   9.58140200e-01,
          -1.13559660e+00,   2.46951600e-01,  -1.94760910e+00,
           2.01904000e-02,  -1.72571720e+00,   1.29544510e+00,
          -6.22916000e-02,  -2.19196160e+00,  -5.15981000e-01,
          -7.29247000e-02,   7.30818000e-01,   1.97204200e-01,
           6.34473800e-01,  -2.32416010e+00,  -2.53010350e+00,
           3.52847400e-01,   7.61650700e-01,  -3.38542900e-01,
          -2.87288980e+00,  -1.76667440e+00],
        [ -2.58283720e+00,  -1.47009010e+00,  -6.94431000e-02,
           4.79009500e-01,  -4.28775210e+00,  -3.46423680e+00,
           1.32507280e+00,  -3.70160560e+00,  -6.77188200e-01,
          -1.28580910e+00,  -1.94163510e+00,   4.17061200e-01,
           1.06918000e-01,  -5.87997200e-01,  -7.27799800e-01,
           3.01345600e-01,   4.92425000e-02,  -1.52175030e+00,
          -8.50216400e-01,  -1.61152460e+00,  -6.00636400e-01,
          -2.99814200e-01,  -9.84352000e-02,   6.65196800e-01,
           1.05527130e+00,   3.81721600e-01,  -1.98898370e+00,
          -2.41950300e+00,  -2.84293200e-01,  -3.32434600e-01,
          -3.38712150e+00,   1.46171500e-01,   3.82450900e-01,
           6.11567700e-01,  -5.69031300e-01,  -2.17953890e+00,
           7.28711100e-01,  -4.22519000e-01,   1.57261000e-02,
           4.14096500e-01,   9.76785800e-01,  -5.73883600e-01,
           1.39881300e-01,   8.53410800e-01,  -2.92638890e+00,
           3.06597000e-01,   9.28310100e-01,   4.70764400e-01,
           8.01247000e-01,   2.59450100e-01],
        [ -8.14718200e-01,   1.08552130e+00,  -4.58656700e-01,
          -1.17812310e+00,  -9.50010000e-03,  -8.79657300e-01,
          -5.48114100e-01,  -5.49698400e-01,  -3.37831180e+00,
          -3.41109300e-01,  -1.66278690e+00,   5.50204900e-01,
          -2.21412840e+00,   1.08868540e+00,  -5.61856800e-01,
          -5.32174400e-01,   1.14628560e+00,  -1.01320700e+00,
          -2.53521960e+00,  -7.63757100e-01,   7.88646300e-01,
          -4.71299400e-01,   1.41286400e-01,  -1.48664830e+00,
          -6.47511500e-01,   5.06786700e-01,   3.99707600e-01,
          -2.78944600e-01,   2.78847400e-01,   1.91051270e+00,
          -6.47628200e-01,   2.97667600e-01,  -1.33201580e+00,
           7.86414200e-01,  -2.99814200e-01,   1.37338570e+00,
          -2.62614040e+00,  -1.75768180e+00,  -2.29326350e+00,
          -6.69304400e-01,  -3.02049700e-01,  -7.57453700e-01,
          -2.64618470e+00,  -7.89128600e-01,   1.23366320e+00,
          -1.25101240e+00,   2.99367300e-01,  -1.01538270e+00,
          -3.47854300e-01,   1.48596630e+00],
        [ -3.14421100e-01,   1.48970390e+00,   7.58866900e-01,
          -1.28134600e-01,  -1.57011520e+00,  -3.16038400e-01,
          -5.65070800e-01,   6.89610300e-01,   4.49312000e-02,
           1.64113810e+00,   1.27941090e+00,   1.41627490e+00,
           1.15315290e+00,  -4.17570800e-01,  -1.21702880e+00,
           6.12679800e-01,  -5.76067900e-01,  -1.35672740e+00,
          -1.23196340e+00,  -4.99783200e-01,  -1.41193030e+00,
          -1.65479230e+00,  -3.88462700e-01,  -7.74739900e-01,
          -1.20079170e+00,   6.97802700e-01,   8.99620400e-01,
          -1.69724430e+00,  -1.86835000e-01,  -9.30235200e-01,
           4.95354900e-01,  -1.73421620e+00,   6.02600700e-01,
          -3.49824120e+00,  -2.23184900e-01,   2.70612400e-01,
          -1.46028420e+00,  -8.16988900e-01,  -4.50009600e-01,
          -7.25908800e-01,  -3.51765200e-01,  -9.41124500e-01,
          -6.73836500e-01,  -1.90191460e+00,  -3.48827100e-01,
           2.50192200e-01,  -1.75768180e+00,   6.56215000e-02,
          -3.82250060e+00,  -1.51110000e-02],
        [ -4.20870420e+00,   6.97654800e-01,   4.63233900e-01,
           1.01878240e+00,   4.71580100e-01,  -8.12500700e-01,
           6.90350000e-02,   4.22331100e-01,  -8.70325000e-01,
          -1.04692690e+00,   3.49999800e-01,  -1.29750740e+00,
          -1.07421180e+00,   1.03902880e+00,  -1.34165970e+00,
          -2.26136100e-01,  -1.34304400e-01,  -8.18138500e-01,
          -1.21283980e+00,  -2.81768610e+00,  -5.38649300e-01,
          -1.15173350e+00,  -2.71859780e+00,  -2.16258100e+00,
          -9.61909400e-01,  -1.81965670e+00,  -6.42727700e-01,
           4.18239400e-01,  -5.15301100e-01,  -3.52466600e-01,
          -1.22964300e+00,  -5.86973900e-01,  -2.49629280e+00,
           1.06723980e+00,  -3.62064200e-01,  -2.35366550e+00,
           3.08600000e-01,  -2.09726590e+00,  -1.59205810e+00,
           1.03008390e+00,  -2.34395900e-01,  -7.37031600e-01,
           5.55584000e-02,  -1.80776500e-01,  -8.40612500e-01,
          -1.03796570e+00,  -8.52107000e-01,  -1.07047120e+00,
           1.57261000e-02,  -2.19827200e+00],
        [ -1.17778900e-01,   4.52858500e-01,   9.68623600e-01,
          -1.17890600e+00,  -3.13036940e+00,   4.40069000e-02,
          -4.99681610e+00,   1.32097500e-01,   2.29937000e-01,
          -4.36819790e+00,  -2.81510000e-02,  -2.52355500e-01,
          -1.51259320e+00,  -5.12858700e-01,   7.35137900e-01,
          -1.99230590e+00,   1.00183000e+00,   5.69783700e-01,
           1.47486560e+00,   7.13296600e-01,   3.02938100e-01,
           6.33004600e-01,  -4.51692700e-01,  -1.62874560e+00,
           3.44410500e-01,  -1.24714400e-01,  -2.14612320e+00,
          -5.12790000e-02,  -1.99760080e+00,   5.76780100e-01,
          -4.87298000e-02,  -3.08872550e+00,  -8.89978100e-01,
          -4.41026400e-01,  -8.67696900e-01,  -6.65366600e-01,
          -2.41412530e+00,  -1.96626940e+00,  -1.94369100e-01,
          -1.59876090e+00,   1.07957270e+00,  -2.67405100e-01,
           8.04541800e-01,   1.42355810e+00,   4.64494100e-01,
          -4.25392900e-01,   4.27922800e-01,  -3.56614600e-01,
          -1.92931320e+00,  -1.10658690e+00],
        [ -2.58046830e+00,   5.67263400e-01,  -8.20637000e-01,
          -2.28565400e-01,  -6.77000600e-01,  -1.16410820e+00,
           2.34304000e-01,  -8.82502300e-01,   4.71580100e-01,
           1.08747280e+00,  -1.94760910e+00,   3.31515700e-01,
          -1.84930020e+00,  -1.56992790e+00,  -1.86966780e+00,
           1.91742700e-01,  -5.26630800e-01,  -9.77693900e-01,
          -1.67246000e-01,   5.76716500e-01,   7.76993200e-01,
          -1.60962500e-01,   4.32393900e-01,  -5.33859300e-01,
          -2.47336600e-01,   1.30059900e-01,   1.32507280e+00,
          -2.68091110e+00,  -5.93558100e-01,   7.60812000e-02,
           6.62473000e-01,  -9.99182100e-01,  -5.46324700e-01,
          -1.18344820e+00,  -2.96684620e+00,   1.69242100e-01,
          -1.46736440e+00,   6.77502100e-01,   5.55584000e-02,
          -3.23368400e-01,   1.28037330e+00,   1.30792800e-01,
           1.05328760e+00,  -2.32535670e+00,   4.85900300e-01,
           3.37676800e-01,  -9.91939400e-01,   7.76993200e-01,
          -8.31340000e-01,  -1.99307300e-01],
        [ -2.71859780e+00,  -4.58285300e-01,  -3.46121000e-01,
          -1.69549800e+00,  -2.31780200e-01,  -1.79522140e+00,
          -6.53807500e-01,  -3.98803000e-01,  -9.44847100e-01,
          -2.31571440e+00,  -6.69843200e-01,  -2.71477750e+00,
          -5.78479000e-02,  -4.66120700e-01,   5.72646000e-02,
          -9.25632400e-01,  -9.70596000e-01,   2.36888000e-02,
          -7.35642000e-02,   6.45600600e-01,   9.91710600e-01,
          -8.66493400e-01,  -5.77948200e-01,  -2.14427500e-01,
          -5.49748200e-01,  -7.45653700e-01,   5.46405200e-01,
          -1.35984500e+00,  -2.40701760e+00,   8.94875100e-01,
           1.53264620e+00,  -8.11502800e-01,  -4.87802300e-01,
          -5.18078000e-02,  -1.69696300e-01,  -3.25695900e+00,
          -1.97580970e+00,  -4.71545800e-01,   1.59509780e+00,
          -2.94408210e+00,  -9.58624500e-01,  -1.18115000e-01,
          -3.80914700e+00,   3.74238200e-01,   4.07289200e-01,
           6.46795500e-01,  -2.68802390e+00,  -2.49095000e-02,
           9.61240100e-01,  -3.08698000e-01],
        [  4.70200900e-01,  -3.55770230e+00,  -2.34323060e+00,
          -3.49824120e+00,  -2.40701760e+00,  -1.87021900e-01,
          -1.00300800e+00,  -1.97688890e+00,  -2.74753300e-01,
           3.39655400e-01,  -2.23612140e+00,  -1.30466830e+00,
          -2.23731580e+00,  -1.48545930e+00,  -3.43605000e-02,
           1.04569800e-01,  -8.10604100e-01,  -7.57453700e-01,
          -6.15482600e-01,   1.64296300e-01,  -2.30349360e+00,
          -1.11749290e+00,   9.22065300e-01,  -1.61074780e+00,
          -8.78502600e-01,  -5.85119900e-01,  -4.46360200e-01,
          -1.27553000e-02,   6.30773900e-01,   1.56455250e+00,
          -4.22519000e-01,   7.84273800e-01,  -5.09104900e-01,
          -2.64206660e+00,   1.12190480e+00,  -3.01200600e-01,
          -8.66493400e-01,  -1.02524530e+00,   9.80630100e-01,
           1.88272400e-01,  -3.51764100e+00,  -1.89762630e+00,
          -1.00785750e+00,  -1.41947520e+00,   2.09187500e-01,
          -6.72293200e-01,  -4.96574380e+00,   1.22219300e-01,
           3.99451000e-01,   1.42328500e-01]],

       [[  3.46388300e-01,  -2.10218530e+00,   3.61883000e-02,
           9.90311900e-01,  -5.39143900e-01,  -2.69089100e-01,
           6.65196800e-01,   3.99112200e-01,  -2.08041000e-01,
          -7.61066900e-01,  -3.13031220e+00,  -5.63238890e+00,
          -8.55266900e-01,  -1.89627120e+00,  -1.85814980e+00,
           7.81006000e-01,   5.72618000e-01,  -6.10121800e-01,
           2.60721400e-01,   6.12348500e-01,  -9.79623200e-01,
          -3.14313660e+00,   1.10967790e+00,  -2.36095370e+00,
          -5.30390910e+00,  -1.15539470e+00,  -3.40960000e-03,
          -4.36175940e+00,   1.32703510e+00,  -4.37662800e-01,
           1.83318700e-01,  -6.79779200e-01,   7.45659900e-01,
          -2.11169800e-01,   3.31874500e-01,   1.74709600e-01,
           1.00840540e+00,  -2.55194400e-01,   4.49312000e-02,
          -3.98929960e+00,  -2.86737500e-01,   8.05352000e-02,
          -2.57046000e-01,  -1.22114300e-01,   7.14006000e-02,
          -2.29779800e-01,  -2.69363880e+00,  -4.28995700e-01,
           2.19509200e-01,  -2.45611950e+00],
        [  7.37340700e-01,  -3.23244200e-01,   2.22956100e-01,
          -1.30112500e+00,  -2.57375070e+00,   5.62659000e-02,
          -2.96084530e+00,   1.37294500e+00,  -2.62271150e+00,
          -4.08293730e+00,   9.51209000e-02,  -2.28799950e+00,
          -4.96342200e-01,  -5.26630800e-01,  -3.64263700e-01,
          -1.99417330e+00,  -9.33376100e-01,  -2.96812100e-01,
          -5.78211000e-01,  -3.54247640e+00,   7.33177100e-01,
          -5.15702600e-01,  -3.14541320e+00,  -5.82752000e-02,
          -7.21654000e-02,  -4.59401400e-01,  -9.20104400e-01,
          -1.88350630e+00,   8.72912000e-01,  -3.29647150e+00,
          -1.81216030e+00,  -1.52900360e+00,  -1.51017710e+00,
          -9.22687100e-01,   7.39791900e-01,   4.49312000e-02,
           5.69848400e-01,  -8.10604100e-01,   6.51445000e-01,
          -5.69794000e-01,  -9.42723900e-01,  -6.16804400e+00,
          -1.11404900e+00,  -2.30349360e+00,  -2.17527750e+00,
          -6.81314600e-01,  -2.30442190e+00,  -1.88360000e-01,
           1.54222750e+00,  -2.14427500e-01],
        [ -1.22809300e+00,  -1.62064560e+00,  -3.29292020e+00,
          -6.69255100e-01,   1.07652630e+00,   4.31613700e-01,
          -3.79429360e+00,  -1.93860800e-01,  -4.25392900e-01,
          -2.74812160e+00,  -2.27822100e-01,  -2.01892730e+00,
          -4.77257600e-01,   4.00029300e-01,   1.02265130e+00,
          -1.16862240e+00,  -1.41719270e+00,  -1.03057300e-01,
          -6.46895500e-01,  -1.71147090e+00,  -3.18220740e+00,
          -3.10389520e+00,   2.28233400e-01,  -1.77543470e+00,
          -5.73123400e-01,  -5.45301230e+00,  -2.39946210e+00,
           1.65143750e+00,  -1.46691480e+00,   4.06395400e-01,
           1.24415970e+00,  -9.37662100e-01,   1.43310410e+00,
          -1.61611190e+00,  -5.65641000e-02,  -2.97767460e+00,
          -1.18792280e+00,   3.74238200e-01,   1.43399360e+00,
          -8.09081600e-01,  -2.47751900e-01,  -9.91780600e-01,
          -2.49629280e+00,   1.05328760e+00,  -2.41179440e+00,
           5.83974400e-01,  -5.99360600e-01,   7.13296600e-01,
          -1.19504850e+00,   4.97720200e-01],
        [  1.10319360e+00,   2.29261800e-01,   1.50555280e+00,
          -2.20886960e+00,  -3.44303100e-01,  -1.09497500e-01,
          -1.17507400e-01,   8.96822900e-01,  -4.28995700e-01,
          -1.49590870e+00,  -6.66802300e-01,  -1.19504850e+00,
          -1.13559660e+00,   3.81721600e-01,  -4.79832800e-01,
          -1.50865300e-01,  -1.03633180e+00,  -8.82521300e-01,
          -2.35136110e+00,  -2.39654940e+00,  -7.71322900e-01,
           2.94492500e-01,  -7.89893000e-02,  -2.75148770e+00,
          -9.70596000e-01,  -1.38455210e+00,   5.72634700e-01,
          -4.76594190e+00,  -8.04342800e-01,  -1.69696300e-01,
          -3.11329200e-01,  -2.80694990e+00,  -4.07557200e-01,
           1.91051270e+00,  -1.54324690e+00,  -1.07066570e+00,
          -7.37147900e-01,  -1.86434340e+00,  -6.04725300e-01,
           7.10529900e-01,  -2.06603800e-01,   2.05390600e-01,
          -1.12157270e+00,   2.22433100e-01,   3.13950000e-01,
          -4.32966700e-01,  -5.68384100e-01,  -2.55183370e+00,
          -5.50517300e-01,  -1.75141240e+00],
        [ -6.70447900e-01,  -4.62123080e+00,  -7.06697300e-01,
           3.64558600e-01,   1.11528130e+00,  -4.46360200e-01,
          -1.68435000e-02,  -1.09141930e+00,  -1.79080540e+00,
          -7.27617000e-02,   1.49728370e+00,  -1.87866380e+00,
          -6.61659400e-01,  -4.65719900e-01,  -1.47009010e+00,
          -8.92910500e-01,  -8.14718200e-01,   1.35477840e+00,
          -1.49520760e+00,   5.07685200e-01,  -2.81923500e-01,
          -1.64621980e+00,  -4.30757900e-01,  -1.49520760e+00,
           1.14225170e+00,  -5.31728200e-01,  -3.30859730e+00,
          -1.61043910e+00,   7.87100900e-01,  -7.53955800e-01,
          -1.02973940e+00,  -1.58717600e-01,   6.44277500e-01,
           3.94451300e-01,  -1.21512000e-02,  -1.89155100e+00,
          -1.22114300e-01,   8.51563700e-01,   8.72369900e-01,
           1.20811900e-01,  -1.94369100e-01,   5.64970800e-01,
           1.01318270e+00,  -4.02621700e-01,   1.12774600e-01,
           7.86463700e-01,  -6.83327900e-01,   6.65196800e-01,
           2.28221100e-01,   4.83277300e-01],
        [  9.65195000e-01,   1.27312900e-01,   2.46951600e-01,
           7.54943300e-01,  -1.21512000e-02,  -7.29247000e-02,
          -7.57409000e-02,  -7.89736000e-02,  -7.02813000e-02,
          -2.05004660e+00,  -8.15585400e-01,  -1.54092350e+00,
          -5.79679700e-01,   8.31344000e-02,   8.98438400e-01,
          -1.24402710e+00,  -3.76087600e-01,   1.03008390e+00,
          -5.39143900e-01,  -4.46241400e-01,  -8.30170300e-01,
          -5.50517300e-01,  -9.16631000e-02,  -5.90851200e-01,
          -5.93558100e-01,  -1.29020310e+00,   1.30170820e+00,
           1.35710880e+00,  -2.71850500e-01,  -7.26908200e-01,
           3.52032600e-01,  -1.20106200e+00,   6.12679800e-01,
          -2.44885300e+00,  -2.31245130e+00,   1.03198810e+00,
          -1.16475830e+00,   4.62824500e-01,   1.29598770e+00,
          -2.44847930e+00,   1.15084720e+00,  -7.13633700e-01,
          -1.99230590e+00,   1.29122410e+00,  -5.07219800e-01,
           3.08506000e-01,  -1.17890600e+00,  -7.57409000e-02,
          -1.04692690e+00,  -7.61006200e-01],
        [  4.78696200e-01,  -1.19993000e-01,  -1.34757150e+00,
          -4.51231700e-01,  -2.90141600e+00,   1.51450490e+00,
          -2.06000150e+00,   7.98612800e-01,  -5.99360600e-01,
           1.05055660e+00,  -6.70587000e-02,  -3.04889800e-01,
          -1.41589060e+00,  -1.75561010e+00,  -2.56942100e-01,
          -1.17095230e+00,  -2.26161670e+00,   4.73345500e-01,
           1.46303100e-01,  -2.92190670e+00,  -1.98280790e+00,
          -1.64462450e+00,  -1.78003450e+00,  -6.11644500e-01,
          -2.08494190e+00,   1.10327020e+00,   3.15388000e-02,
           1.47155600e-01,  -2.80302200e-01,  -2.49751500e-01,
          -6.28288000e-01,  -2.65227900e-01,  -4.44279900e-01,
          -3.54338200e-01,  -2.66324810e+00,  -1.26844280e+00,
          -1.27402390e+00,   1.51364540e+00,   1.04094120e+00,
           2.02104200e-01,  -2.50167500e+00,  -2.96812100e-01,
          -7.06697300e-01,   1.02882480e+00,  -6.35385000e-02,
           4.97103600e-01,   8.12238000e-01,   1.93595900e-01,
           6.91876400e-01,  -4.02770000e-02],
        [  4.91052200e-01,  -6.72166100e-01,  -2.00270300e-01,
          -6.51304900e-01,   2.19428900e-01,   1.52717600e-01,
          -2.18087000e-01,   3.95623800e-01,  -1.86337920e+00,
          -5.68405800e-01,  -3.77525600e-01,   1.32604520e+00,
           6.72005400e-01,   9.70896800e-01,  -2.19827200e+00,
           3.53589300e-01,  -9.67120000e-03,  -2.63840470e+00,
           2.25160000e-02,  -2.60453300e-01,  -2.79634000e-01,
          -8.58154700e-01,   2.62671000e-02,   1.02634130e+00,
           7.13296600e-01,  -1.06894790e+00,   1.97295500e-01,
          -1.16813330e+00,  -1.69784160e+00,  -1.06880600e+00,
          -3.00909000e-02,   4.64494100e-01,   1.14234300e-01,
          -8.55266900e-01,   4.27922800e-01,   5.28746700e-01,
          -2.12504600e-01,  -6.30900200e-01,   1.22937530e+00,
          -1.59398200e-01,  -8.40612500e-01,  -1.45976080e+00,
          -5.78508900e-01,   1.42987230e+00,  -1.81059800e-01,
          -2.64965540e+00,   5.45533600e-01,   1.20892100e-01,
          -5.79679700e-01,  -1.69377740e+00],
        [  9.29287300e-01,  -1.31197550e+00,  -6.47982800e-01,
          -2.25759900e-01,  -1.32687950e+00,   8.45917300e-01,
          -1.41646900e-01,  -5.64308600e-01,  -1.35983500e-01,
          -5.15310250e+00,  -1.99336420e+00,  -1.40212600e+00,
          -4.64735450e+00,   6.44290200e-01,  -4.65719900e-01,
          -2.26161670e+00,  -2.07692370e+00,  -1.05032900e-01,
          -2.03755770e+00,  -4.11547200e-01,  -1.27144810e+00,
          -5.16683300e-01,  -7.85195600e-01,  -3.21986320e+00,
          -3.69969480e+00,   4.36499000e-02,  -1.35097400e-01,
           4.44850400e-01,   6.33453600e-01,  -2.15547360e+00,
           1.17630260e+00,  -9.80372300e-01,  -1.82415800e-01,
           8.11731200e-01,   4.00741000e-02,  -2.06031500e-01,
           5.61495500e-01,   7.64780000e-03,  -7.64929100e-01,
          -1.51017710e+00,  -4.45179800e-01,  -1.15447700e+00,
           9.08193000e-02,  -2.88276700e-01,  -2.11913260e+00,
           5.42614100e-01,  -2.86737500e-01,  -2.53942550e+00,
          -1.61074780e+00,   1.21830000e-02],
        [  9.20155000e-02,   4.05237600e-01,  -9.39731800e-01,
          -1.37668560e+00,  -3.00471970e+00,  -8.64072600e-01,
          -2.17953890e+00,  -3.26463600e-01,  -1.31305900e+00,
           1.31581450e+00,  -1.68135460e+00,  -5.65578900e-01,
          -1.52739510e+00,   2.71065900e-01,  -4.45779600e-01,
          -3.36663000e-01,   9.43598100e-01,  -9.30235200e-01,
          -1.07570210e+00,   3.65215400e-01,   5.43715400e-01,
           1.25043210e+00,  -2.26161670e+00,  -7.95540900e-01,
           1.63820900e-01,  -1.50520010e+00,   1.08187150e+00,
          -3.04889800e-01,  -7.70469500e-01,   5.88844700e-01,
          -9.12028300e-01,  -2.23184900e-01,  -5.46804700e-01,
          -1.30981210e+00,  -1.57290100e-01,  -5.32174400e-01,
          -4.92193400e-01,   3.37505000e-01,  -8.24998800e-01,
           1.07068800e+00,   6.26718000e-01,  -7.66455600e-01,
          -1.33107360e+00,   4.83439800e-01,  -7.12508000e-01,
          -1.60301930e+00,  -4.53323590e+00,  -2.43178770e+00,
          -1.86966780e+00,  -1.03857700e-01]],

       [[ -2.54762740e+00,  -2.41395000e-01,   6.39197600e-01,
           6.56647100e-01,  -4.51951000e-02,   3.19561100e-01,
          -4.39967760e+00,   5.17862300e-01,  -9.69205400e-01,
          -1.25460400e-01,  -2.30657000e-02,   5.01587300e-01,
          -1.68806530e+00,   6.62270900e-01,   1.11358540e+00,
           1.24705630e+00,   1.47155600e-01,   1.25606000e-01,
           5.32529500e-01,  -8.12500700e-01,  -2.78546340e+00,
           1.81543020e+00,  -3.82250060e+00,  -2.53835090e+00,
           1.64113810e+00,  -6.22731400e-01,  -3.02706700e-01,
          -4.50354110e+00,  -6.15482600e-01,  -7.18919300e-01,
          -2.75180000e-03,  -1.14366360e+00,  -2.99540400e-01,
          -4.32966700e-01,  -5.51661000e-01,  -1.22217550e+00,
           1.62389720e+00,  -3.60170600e-01,  -1.27214960e+00,
          -1.83435750e+00,  -8.50595700e-01,  -1.43895930e+00,
          -1.09135540e+00,   3.31515700e-01,  -7.44343400e-01,
           6.72005400e-01,   6.62190000e-01,   4.06605400e-01,
          -4.58285300e-01,   7.15120100e-01],
        [  2.76975900e-01,  -8.41847200e-01,   1.85725700e-01,
          -1.09398900e-01,  -1.18547220e+00,   5.71694700e-01,
          -6.70447900e-01,  -5.15981000e-01,  -7.33809000e+00,
          -1.07066570e+00,  -2.16654410e+00,   1.22267300e-01,
          -4.44932300e-01,  -2.23184900e-01,   3.99100000e-01,
           3.39655400e-01,  -8.28476600e-01,  -1.03796570e+00,
           2.71057900e-01,   1.09490440e+00,  -8.24998800e-01,
          -2.59179500e-01,  -1.03796570e+00,   7.30818000e-01,
          -8.53639000e-02,   1.06797640e+00,  -2.37379350e+00,
          -2.91920990e+00,  -2.36050740e+00,   1.96882250e+00,
          -2.71859780e+00,   3.12711000e-02,   1.12130900e-01,
          -2.63151200e-01,  -3.50140600e-01,  -3.33611000e-01,
          -7.63757100e-01,  -4.75171900e-01,  -1.30801090e+00,
          -1.77784400e+00,   5.81783100e-01,   2.97667600e-01,
           7.18312400e-01,  -1.10780700e+00,   9.16240300e-01,
          -1.10728020e+00,   9.89017000e-02,  -2.65386300e+00,
           3.99112200e-01,  -3.55584400e-01],
        [ -5.32274610e+00,   1.24709860e+00,   1.02896900e+00,
          -1.83594160e+00,   1.04442970e+00,  -9.75858000e-01,
           9.67380700e-01,  -2.32038160e+00,  -6.14918100e-01,
          -2.48315400e+00,   1.22937530e+00,  -1.61401060e+00,
           2.19607900e-01,  -1.98796150e+00,  -1.55862900e-01,
          -5.82752000e-02,  -6.37483700e-01,  -2.11913260e+00,
           3.49967800e-01,   7.27090600e-01,  -4.02621700e-01,
          -7.22309800e-01,  -1.39531320e+00,  -1.09141930e+00,
          -7.96259000e-02,   6.05474100e-01,   1.20523450e+00,
           9.36758100e-01,  -1.47009010e+00,   1.10269450e+00,
           6.20459700e-01,  -3.83494500e-01,  -3.23608870e+00,
          -1.14730710e+00,   8.68395800e-01,  -1.30711910e+00,
          -2.92288990e+00,  -1.56359580e+00,  -6.94066700e-01,
           5.05572700e-01,  -1.29480940e+00,  -1.30912100e-01,
          -2.43101790e+00,   1.32171200e-01,  -1.21512000e-02,
          -5.80931000e-02,  -3.63119700e-01,   8.68395800e-01,
          -1.72873970e+00,   6.78574200e-01],
        [ -9.23248400e-01,  -1.49590870e+00,   5.69496000e-02,
           6.37400100e-01,  -2.25921010e+00,   2.79520800e-01,
           2.05390600e-01,  -3.98803000e-01,  -1.64773140e+00,
           1.14998770e+00,  -4.42968100e-01,   6.73733500e-01,
          -4.17570800e-01,   1.94545000e-01,  -4.56892300e-01,
          -7.19128700e-01,  -3.97330600e-01,  -9.62711400e-01,
           7.62067600e-01,  -6.99950000e-03,   5.28746700e-01,
          -9.44409000e-01,  -1.85814980e+00,  -1.68245120e+00,
           2.19656200e-01,  -5.82003500e-01,  -2.79377090e+00,
          -1.30112500e+00,  -1.86826110e+00,  -8.37300300e-01,
          -1.90191460e+00,  -1.81059800e-01,  -1.57986570e+00,
          -6.40094000e-01,   4.76963100e-01,  -1.18661210e+00,
           2.68110200e-01,  -7.63757100e-01,  -3.51765200e-01,
          -1.53896600e-01,   3.14348000e-02,  -8.95753600e-01,
          -6.66922900e-01,  -3.85126340e+00,   8.67757000e-01,
           1.37417300e-01,   3.94451300e-01,  -1.54623880e+00,
          -9.66347200e-01,  -5.51832800e-01],
        [ -2.16917590e+00,  -5.25231300e-01,   7.73897300e-01,
          -9.70596000e-01,   6.23189700e-01,  -7.50947600e-01,
          -3.90765600e-01,  -4.67554940e+00,  -3.05525750e+00,
           8.35335800e-01,  -8.41847200e-01,  -5.39255000e-02,
          -1.04906660e+00,  -1.53054300e-01,  -1.88480680e+00,
          -9.74117300e-01,  -2.20669320e+00,  -1.54787490e+00,
          -5.48273800e-01,   8.13483200e-01,  -6.71789100e-01,
          -9.78777200e-01,  -5.99360600e-01,   4.01970000e-01,
          -9.13951000e-02,  -7.50374000e-01,   9.92450800e-01,
           8.53454600e-01,   7.07207300e-01,  -4.58285300e-01,
          -6.80413000e-02,  -1.49508190e+00,  -1.41325790e+00,
           8.05352000e-02,  -9.81202300e-01,   2.46951600e-01,
           4.33674000e-01,  -1.83764660e+00,  -1.37330900e-01,
          -1.07421180e+00,  -1.62285040e+00,  -3.10389520e+00,
           3.16400500e-01,  -1.94597090e+00,  -1.14586880e+00,
           1.66771980e+00,   1.01425420e+00,  -1.28580910e+00,
           8.99117500e-01,  -3.40960000e-03],
        [  7.98612800e-01,  -4.14314400e-01,  -2.23759500e-01,
          -1.16359920e+00,   7.27090600e-01,  -8.41847200e-01,
          -2.84536100e-01,  -5.78479000e-02,  -3.60865300e-01,
           9.29287300e-01,  -6.69983000e-01,  -4.77052480e+00,
           6.22819300e-01,   5.36473300e-01,  -2.71850500e-01,
          -9.13175000e-02,  -7.41189600e-01,  -5.32834700e-01,
           3.19561100e-01,  -2.60387500e-01,  -1.03857700e-01,
           1.27312900e-01,  -1.80279630e+00,   1.01831860e+00,
          -1.28134600e-01,  -1.66309390e+00,  -1.76203710e+00,
           3.03876500e-01,   1.82810500e-01,  -1.01881170e+00,
          -1.85851830e+00,   5.10252400e-01,  -2.99814200e-01,
          -6.24711000e-01,   3.85084600e-01,  -1.02472550e+00,
           1.08868540e+00,  -1.04633130e+00,   4.41511100e-01,
           5.62659000e-02,   5.78671000e-01,   3.84839600e-01,
          -2.36914200e-01,   5.04776500e-01,  -1.21967650e+00,
           1.39840200e-01,  -3.08259400e-01,   1.25113630e+00,
          -3.18220740e+00,  -1.16410820e+00],
        [  6.08393200e-01,  -8.46871000e-01,  -2.30548820e+00,
          -6.58322100e-01,  -2.39652820e+00,  -3.90676700e+00,
          -1.64458890e+00,  -2.23759500e-01,  -1.30112500e+00,
           7.49102200e-01,  -1.87749480e+00,   1.07524100e+00,
          -3.10137850e+00,   8.72907000e-02,  -2.87288980e+00,
           6.04921000e-02,   3.41494600e-01,  -3.15708000e-02,
          -9.81202300e-01,   1.08747280e+00,  -1.31349300e-01,
          -2.36914200e-01,  -1.61401060e+00,  -1.77694530e+00,
           6.83157700e-01,  -2.87857110e+00,   8.35182500e-01,
          -4.25080350e+00,  -6.75831700e-01,  -2.39793920e+00,
          -1.18431040e+00,   3.08506000e-01,  -2.20235610e+00,
          -2.14397410e+00,  -6.45676500e-01,   1.08856740e+00,
          -7.05370800e-01,   2.79533000e-02,  -1.99230590e+00,
          -2.25151100e-01,  -1.40683000e-02,  -3.54100300e-01,
           9.86625500e-01,  -1.63518400e+00,  -4.88748710e+00,
          -6.00678700e-01,  -1.88053500e+00,   3.70434800e-01,
          -2.34323060e+00,   6.51445000e-01],
        [ -7.57942500e-01,   3.64558600e-01,  -4.80018700e-01,
           9.08738600e-01,  -6.88678200e-01,  -1.30466830e+00,
          -1.49318750e+00,  -2.51052300e-01,  -8.38065300e-01,
           5.28746700e-01,   5.49934100e-01,  -3.42606930e+00,
           7.48656700e-01,  -9.22687100e-01,  -1.70769300e-01,
          -5.46389400e-01,  -8.67696900e-01,   2.22272100e-01,
           1.72367900e-01,   8.80045900e-01,   6.86769900e-01,
          -2.21057380e+00,  -4.96342200e-01,   3.26979800e-01,
          -1.09113560e+00,   7.59931000e-01,   3.89118900e-01,
          -1.62577910e+00,  -3.04279160e+00,  -1.37512600e-01,
          -2.69853030e+00,   1.04301040e+00,   4.32393900e-01,
          -6.39372800e-01,  -1.14986440e+00,  -1.22129120e+00,
           1.45859840e+00,  -1.14366360e+00,  -1.74368200e+00,
          -1.24967710e+00,  -9.74791600e-01,   5.25567400e-01,
           4.19968000e-01,  -1.65517800e-01,   1.17904800e-01,
          -2.16917590e+00,   1.93595900e-01,   1.42987230e+00,
          -1.54826990e+00,  -1.50397560e+00],
        [  5.29753100e-01,  -8.92509500e-01,   2.94961000e-02,
          -2.32535670e+00,   7.96773700e-01,  -3.95206010e+00,
           3.74592700e-01,   1.21427570e+00,  -4.72524300e-01,
          -1.46968530e+00,   1.96882250e+00,  -4.14605970e+00,
          -1.89481270e+00,  -1.31547380e+00,   1.30157480e+00,
          -1.00221260e+00,  -2.49095000e-02,  -1.95576460e+00,
          -2.77018600e-01,  -3.46543200e-01,  -1.77694530e+00,
          -5.53705000e-01,  -2.66655240e+00,   9.25289000e-02,
           6.91332300e-01,  -8.40612500e-01,   1.94545000e-01,
           7.10751600e-01,   1.43339260e+00,   8.86566700e-01,
          -1.34165970e+00,  -2.35366550e+00,   1.43225200e+00,
           1.31581450e+00,  -9.39731800e-01,  -4.83009400e-01,
          -2.34316700e-01,   5.68705000e-01,  -2.05211680e+00,
          -1.94849720e+00,  -8.82381000e-02,   1.20892100e-01,
           1.86079000e-02,   5.17862300e-01,   7.10961200e-01,
           8.88083600e-01,  -1.00945190e+00,   3.65215500e-01,
           9.91262400e-01,   6.26718000e-01],
        [ -6.05720900e-01,  -2.46298990e+00,   1.25364730e+00,
           1.90065390e+00,  -2.78040770e+00,  -3.44829900e-01,
           1.41627490e+00,   1.06228970e+00,   7.75340900e-01,
           1.19402650e+00,   2.77213600e-01,   8.33942200e-01,
          -1.94163510e+00,  -5.52281500e-01,  -2.08535220e+00,
           4.98862200e-01,  -9.81109800e-01,  -5.49698400e-01,
           6.33004600e-01,  -2.36516360e+00,   2.24281600e-01,
          -4.71545800e-01,  -1.96583420e+00,  -1.57290100e-01,
           9.80630100e-01,  -1.45761120e+00,  -8.82381000e-02,
          -1.04268190e+00,  -1.09581980e+00,  -2.11760410e+00,
           1.40296250e+00,   7.80435000e-01,   3.99707600e-01,
          -1.27796160e+00,   8.91334700e-01,   1.32604520e+00,
          -2.26482110e+00,  -1.88043180e+00,  -4.99962100e-01,
          -1.10640040e+00,  -1.20143630e+00,   5.08599600e-01,
          -5.95550000e-01,  -9.02656700e-01,   1.69078140e+00,
          -3.42606930e+00,  -2.94809400e-01,   3.27880000e-03,
          -1.97688890e+00,  -6.94431000e-02]]])

    # Variables choice model
    dict['AT_FSP'] = 10
    dict['TD_FSP'] = 10
    dict['Origin'] = np.array([0, 1, 1, 0, 0, 1, 0, 0, 1, 0])
    dict['AT_PSP'] = 10
    dict['TD_PSP'] = 10
    dict['AT_PUP'] = 5
    dict['TD_PUP'] = 10
    dict['Age_veh'] = np.array([0, 0, 0, 1, 0, 0, 1, 0, 0, 0])
    dict['Low_inc'] = np.array([1, 1, 1, 1, 0, 1, 1, 1, 1, 0])
    dict['Res'] = np.array([1, 1, 1, 0, 1, 1, 0, 0, 1, 1])

    return dict

def preprocess(dict):
    ''' Precomputation on the data in order to create the corresponding
        cplex model.
    '''

    ########## Precomputation ##########
    # Priority list
    priority_list = np.empty([dict['I'] + 1, dict['N']])
    for i in range(dict['I'] + 1):
        min = 1
        max = dict['N']
        for n in range(dict['N']):
            if dict['choice_set'][i, n] == 1:
                priority_list[i, n] = min
                min += 1
            else:
                priority_list[i, n] = max
                min -= 1
    dict['priority_list'] = priority_list

    # Exogene utility
    exo_utility = np.empty([dict['I'] + 1, dict['N'], dict['R']])
    for n in range(dict['N']):
        for i in range(dict['I'] + 1):
            for r in range(dict['R']):
                if i == 0:
                    # Opt-Out
                    exo_utility[i, n, r] = (dict['Beta_AT'][n, r] * dict['AT_FSP'] +
                                           dict['Beta_TD'] * dict['TD_FSP'] +
                                           dict['Beta_Origin'] * dict['Origin'][n])
                elif i == 1:
                    # PSP
                    exo_utility[i, n, r] = (dict['ASC_PSP'] +
                                           dict['Beta_AT'][n, r] * dict['AT_PSP'] +
                                           dict['Beta_TD'] * dict['TD_PSP'])
                else:
                    # PUP
                    exo_utility[i, n, r] = (dict['ASC_PUP'] +
                                           dict['Beta_AT'][n, r] * dict['AT_PUP'] +
                                           dict['Beta_TD'] * dict['TD_PUP'] +
                                           dict['Beta_Age_Veh'] * dict['Age_veh'][n])
    dict['exo_utility'] = exo_utility

    # Beta coefficient for endogenous variables
    beta_FEE_PSP = np.empty([dict['N'], dict['R']])
    beta_FEE_PUP = np.empty([dict['N'], dict['R']])
    for n in range(dict['N']):
        for r in range(dict['R']):
            beta_FEE_PSP[n, r] = (dict['Beta_FEE'][n, r] +
                                 dict['Beta_FEE_INC_PSP'] * dict['Low_inc'][n] +
                                 dict['Beta_FEE_RES_PSP'] * dict['Res'][n])
            beta_FEE_PUP[n, r] = (dict['Beta_FEE'][n, r] +
                                 dict['Beta_FEE_INC_PUP'] * dict['Low_inc'][n] +
                                 dict['Beta_FEE_RES_PUP'] * dict['Res'][n])
    dict['endo_coef'] = np.array([np.zeros([dict['N'], dict['R']]), beta_FEE_PSP, beta_FEE_PUP])

    # Calculate bounds on the utility
    lb_U = np.empty([dict['I'] + 1, dict['N'], dict['R']])
    ub_U = np.empty([dict['I'] + 1, dict['N'], dict['R']])
    lb_Umin = np.full((dict['N'], dict['R']), np.inf)
    ub_Umax = np.full((dict['N'], dict['R']), -np.inf)
    M = np.empty([dict['N'], dict['R']])
    for n in range(dict['N']):
        for r in range(dict['R']):
            for i in range(dict['I'] + 1):
                    if dict['endo_coef'][i, n, r] > 0:
                        lb_U[i, n, r] = (dict['endo_coef'][i, n, r] * dict['lb_p'][i] +
                                        dict['exo_utility'][i, n, r] + dict['xi'][i, n, r])
                        ub_U[i, n, r] = (dict['endo_coef'][i, n, r] * dict['ub_p'][i] +
                                        dict['exo_utility'][i, n, r] + dict['xi'][i, n, r])
                    else:
                        lb_U[i, n, r] = (dict['endo_coef'][i, n, r] * dict['ub_p'][i] +
                                        dict['exo_utility'][i, n, r] + dict['xi'][i, n, r])
                        ub_U[i, n, r] = (dict['endo_coef'][i, n, r] * dict['lb_p'][i] +
                                        dict['exo_utility'][i, n, r] + dict['xi'][i, n, r])
                    # Bound for each customer, for each draw
                    if lb_U[i, n, r] < lb_Umin[n, r]:
                        lb_Umin[n, r] = lb_U[i, n, r]
                    if ub_U[i, n, r] > ub_Umax[n, r]:
                        ub_Umax[n, r] = ub_U[i, n, r]

            # Calcule the big-M values
            M[n, r] = ub_Umax[n, r] - lb_Umin[n, r]
    dict['lb_U'] = lb_U
    dict['ub_U'] = ub_U
    dict['lb_Umin'] = lb_Umin
    dict['ub_Umax'] = ub_Umax
    dict['M'] = M

if __name__ == '__main__':
    dict = getData()
    preprocess(dict)

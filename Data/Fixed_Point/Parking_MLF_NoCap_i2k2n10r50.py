# Data Stackelberg game with capacity, continuous price
import numpy as np

def getData():
    ''' Construct a dictionary containing all the data_file
        Returns:
            dict          dictionarry containing all the data
    '''
    # Initialize the output dictionary
    dict = {}

    # Number of alternatives in the choice set (without considering opt-out)
    dict['I'] = 2

    # Number of customers
    dict['N'] = 10

    # Number of draws
    dict['R'] = 50

    # Number of operators
    dict['K'] = 2

    dict['Operator'] = np.array([0, 1, 2])

    # Lower and upper bound on prices
    dict['lb_p'] = np.array([0.00, 0.00, 0.00]) # lower bound (FSP, PSP, PUP)
    dict['ub_p'] = np.array([0.00, 0.50, 0.50]) # upper bound (FSP, PSP, PUP)

    dict['nPriceLevels'] = 25

    dict['Capacity'] = np.array([60.0, 20.0, 20.0]) # Availability for each alternative (opt-out always available)

    # Choice set of the customers
    #	 		           n1 n2 n3...
    dict['ChoiceSet'] = np.array([[1, 1, 1, 1, 1, 1, 1, 1, 1, 1], # Opt-out (FSP)
                                    [1, 1, 1, 1, 1, 1, 1, 1, 1, 1], # PSP
                                    [1, 1, 1, 1, 1, 1, 1, 1, 1, 1]])  # PUP

    # Parameters choice model
    dict['ASC_PSP'] = 32
    dict['ASC_PUP'] = 34
    dict['Beta_TD'] = -0.612
    dict['Beta_Origin'] = -5.762
    dict['Beta_Age_Veh'] = 4.037
    dict['Beta_FEE_INC_PSP'] = -10.995
    dict['Beta_FEE_RES_PSP'] = -11.440
    dict['Beta_FEE_INC_PUP'] = -13.729
    dict['Beta_FEE_RES_PUP'] = -10.668

    # AT coefficient (10 customers x 50 draws)
    dict['Beta_AT'] = np.array([
                                [  -0.1488684352 ,  -1.5364807688 ,   0.0044298083 ,   0.0635613344 ,  -1.1207988957 ,   0.4963033216 ,   1.2473509384 ,  -0.3149715901 ,  -3.0593740725 ,   0.3680427966 ,  -0.8938924180 ,  -1.1763362987 ,  -0.7366344586 ,  -1.1153899957 ,   0.3466462727 ,  -0.8322155531 ,  -1.0697102718 ,   1.3783364283 ,  -0.8325042050 ,  -0.0183124687 ,  -0.2895702023 ,  -0.3012321960 ,  -0.8100998673 ,   0.0533771597 ,  -1.2243426118 ,   1.1850104743 ,  -2.7531380174 ,   0.2154392106 ,   0.5279354444 ,   0.2093568019 ,  -0.3970922423 ,  -0.0277988153 ,  -1.8501465406 ,   1.3340412341 ,  -0.8263082711 ,  -2.0030847413 ,  -0.3826783396 ,  -0.7116606199 ,  -3.5883083027 ,  -1.4173514431 ,  -1.9573793399 ,   0.0226814154 ,  -0.1894659440 ,  -1.2311327164 ,  -0.8603871274 ,  -1.3244081410 ,  -0.6803801785 ,  -0.3726070901 ,   0.0686326688 ,  -0.9474173769],
                                [   0.3235666507 ,  -1.7255547808 ,  -0.6387094359 ,   1.5898657833 ,  -1.6006977428 ,  -1.5218504158 ,  -0.1713115312 ,  -2.3168694167 ,  -1.2489170980 ,  -1.9137347829 ,  -0.8727933433 ,  -0.6540417429 ,  -1.6328436051 ,  -0.1285135721 ,  -1.3638482316 ,  -1.3156282894 ,  -1.2964533032 ,  -1.9795102578 ,  -0.2673348669 ,  -1.6267724344 ,  -0.8247998275 ,   0.7986595185 ,  -0.8174034627 ,  -1.2314189906 ,  -2.4802011301 ,   1.4152862899 ,   0.8684977394 ,  -1.7409756771 ,  -0.4403696544 ,  -1.9336973892 ,  -0.9866769827 ,  -0.9176954577 ,  -0.8808999075 ,  -0.4810552564 ,  -1.2830813860 ,  -2.0517387155 ,  -0.9381257332 ,  -1.3199729876 ,   0.4279745895 ,   1.0812790085 ,  -0.0036721985 ,  -2.2559885489 ,  -1.8522187604 ,  -2.1664245267 ,  -2.5989143974 ,  -1.3866068144 ,  -2.7364722441 ,  -0.2382955898 ,   0.1730458413 ,  -0.9787476055],
                                [   0.6640852142 ,  -0.5450864175 ,   0.2510126517 ,  -0.5769325491 ,  -1.7195545240 ,   0.5927834585 ,  -0.3129412541 ,  -2.5559110775 ,  -1.9444813578 ,  -0.9366453694 ,  -0.7646046869 ,  -2.8154119513 ,  -1.6290804801 ,  -1.1555725172 ,  -0.3469023889 ,  -0.5276596577 ,   0.2239921239 ,  -0.8538334339 ,  -2.0944546778 ,  -1.0002486799 ,  -0.4911213185 ,  -1.3164059145 ,   0.1234008840 ,  -0.6336971466 ,  -0.4488384322 ,  -1.3353518880 ,   0.3120220615 ,  -0.3294371012 ,   0.5185301722 ,  -1.3467550973 ,   0.0289313843 ,   0.8184216612 ,  -1.4319461617 ,  -2.7760269091 ,  -0.0274766862 ,  -0.7793545555 ,   0.2927151674 ,  -3.0950522408 ,   1.4458156616 ,  -0.0885874064 ,   1.0360442359 ,  -0.8657083660 ,  -1.2458501358 ,  -1.7295285792 ,   0.1292708025 ,  -0.3542716074 ,  -0.7955174391 ,   0.0125510106 ,  -0.2220203716 ,  -0.2570766477],
                                [   0.0964471910 ,  -1.1158437723 ,  -1.2108386794 ,  -1.4364305299 ,  -0.1670576078 ,  -1.6500191266 ,  -2.6738734288 ,  -0.7949906220 ,  -1.4013605634 ,   0.3862639497 ,  -1.7506502006 ,  -3.5079460530 ,  -2.1280085815 ,  -0.2357216120 ,  -0.2525918700 ,  -1.2796059359 ,  -0.6804844259 ,   0.3050838266 ,  -0.9497116692 ,  -2.8115918009 ,   0.2553452723 ,  -2.9739932030 ,  -1.2629848406 ,  -0.8019939664 ,  -2.1892257371 ,  -1.0027007779 ,  -0.2293941273 ,  -1.2357304109 ,  -0.9038996644 ,  -1.8361138343 ,  -2.9799597505 ,   0.6739202892 ,  -1.8231950833 ,  -1.2384815210 ,  -3.0081984564 ,  -0.2721265718 ,  -1.0778194169 ,  -1.3665704947 ,  -1.3621165984 ,  -3.5421882661 ,  -2.4259765113 ,  -0.6209327189 ,  -1.0509898717 ,  -0.4713424981 ,  -1.5066381017 ,   0.6092875561 ,  -0.8393199238 ,  -0.6024943683 ,   0.1786275627 ,  -0.7827204855],
                                [   0.0133201143 ,  -0.3941489065 ,  -1.3965912909 ,  -1.2986909914 ,  -2.5445243614 ,   1.1720766859 ,  -2.2889821237 ,  -1.3941005801 ,  -0.0252508918 ,   0.2064301940 ,   0.4180404660 ,   1.2593633766 ,  -1.0487800280 ,  -0.4561880810 ,   0.0698209042 ,  -0.2442330738 ,  -1.8955333696 ,   0.4954820515 ,  -1.4447299886 ,  -1.4549725568 ,  -1.0101303154 ,  -1.5643148750 ,   0.3234832192 ,   0.6257762470 ,  -0.9297954117 ,  -1.0247193209 ,  -0.7289206121 ,  -2.6970410206 ,  -1.1507398874 ,  -1.1551914125 ,  -0.2935074184 ,  -0.3724128088 ,  -0.8388284665 ,  -1.1504139112 ,  -0.3717247613 ,  -2.2069059450 ,  -1.7256554888 ,  -2.2666619837 ,  -1.1168622359 ,  -0.4713036083 ,  -0.4800540032 ,  -1.0750418958 ,   0.0375279421 ,   0.3124773274 ,   0.1943105136 ,  -0.2052563940 ,  -0.7077665142 ,   0.5766054609 ,   0.2855866654 ,  -1.2346208924],
                                [  -1.3589889578 ,  -0.6431270360 ,  -1.4198651438 ,  -0.2439662250 ,  -1.1587263119 ,  -1.5885497929 ,   0.3047906422 ,  -2.0066580174 ,  -2.4857757174 ,  -0.6645417088 ,  -1.3679638409 ,  -1.6647391377 ,  -1.6515110799 ,  -0.0436767313 ,   0.5464296512 ,  -1.2666446917 ,  -1.9324322546 ,  -0.0928453762 ,   0.9814615125 ,  -1.3148635281 ,  -0.5742262076 ,   0.4568593512 ,   0.3496539784 ,  -0.6836739359 ,  -2.2532296714 ,  -1.7473648479 ,  -1.0783893650 ,  -2.0808821278 ,  -1.2035377532 ,  -0.9687022484 ,  -0.3888150108 ,  -1.4722314654 ,   0.5725393863 ,   0.0343092602 ,  -1.3797154846 ,  -0.2628837302 ,  -0.6735448014 ,  -0.2035952135 ,  -0.5213303466 ,   0.5299110304 ,  -2.1075825765 ,  -1.0123404534 ,  -0.6740042916 ,  -1.1909228396 ,  -1.1666777993 ,  -2.6610698198 ,  -0.7692018848 ,  -0.1020525839 ,  -0.2273831822 ,   1.4529358829],
                                [  -0.3227352219 ,  -1.9079856845 ,  -2.0644433305 ,  -0.7111329009 ,  -1.1671834188 ,   0.4189109592 ,  -1.6416467622 ,  -1.0773117728 ,  -0.0958547809 ,  -1.3494618256 ,  -1.2863214813 ,   1.3242366523 ,   0.0276898862 ,  -0.1477153683 ,  -2.1410921249 ,  -1.0197484671 ,  -0.3240353923 ,   1.4708982787 ,  -0.7584575364 ,  -1.8259147288 ,  -0.9320304479 ,  -1.9513745817 ,  -1.6848909852 ,  -1.2496685074 ,  -1.0411775790 ,  -0.5651707999 ,  -0.7882453719 ,   0.1349591216 ,   0.2910576831 ,  -0.4232239960 ,  -0.5513807498 ,  -1.1728994854 ,  -0.2624448293 ,  -1.6814783262 ,  -1.8378164600 ,  -1.9084881244 ,  -2.2309253258 ,   0.2693720449 ,  -1.1694469639 ,  -0.5130772888 ,  -2.0511301464 ,   0.2159860178 ,  -0.9647734645 ,  -1.2674643179 ,  -2.0363150046 ,  -0.6072469842 ,  -0.9962424203 ,  -0.9880782909 ,  -1.6848575172 ,  -0.7557912228],
                                [   0.0890241236 ,  -0.7673321884 ,   0.2777271537 ,  -0.8282534026 ,  -1.4683378664 ,  -0.8432360412 ,   0.4822554578 ,  -0.3149678748 ,   0.5737851648 ,  -0.3231133985 ,  -1.2333561707 ,  -0.6528353125 ,   0.0103178941 ,  -0.9204073846 ,  -1.7600681560 ,   0.4617278296 ,  -1.3149819498 ,  -1.0186654469 ,   0.8880830011 ,  -1.2997969241 ,  -1.6547830160 ,  -2.3837701588 ,  -1.0580156428 ,  -0.8972359914 ,   0.8925923594 ,   0.0213498419 ,  -0.7864541979 ,  -1.4777986188 ,  -1.1483276104 ,  -1.0634739464 ,  -2.4564417349 ,   1.2615826239 ,   0.9069651620 ,  -0.8449996298 ,  -0.6556443210 ,  -0.2073219002 ,  -0.9012369679 ,   0.1280041602 ,   0.5321926022 ,  -0.8756460695 ,  -0.4599955808 ,  -1.1904317640 ,  -0.4243294166 ,  -0.4458768666 ,  -0.4190200490 ,  -1.1816375126 ,  -1.6792493017 ,  -0.0171721693 ,  -2.2715081105 ,  -2.5939502651],
                                [   0.6833164823 ,  -0.4698724587 ,  -1.8555216949 ,  -3.2768966490 ,  -0.3464466727 ,  -1.9244752917 ,  -3.4478290378 ,  -0.7821557737 ,  -3.0274266861 ,  -2.0091220708 ,  -0.1817598588 ,  -1.2431982508 ,  -1.0651125009 ,   0.6819477003 ,  -0.1021386341 ,  -0.3715202681 ,  -1.2163692960 ,  -0.1856342948 ,   0.1444964898 ,   0.3085760529 ,  -0.7152801059 ,  -0.7920009941 ,  -0.8990167956 ,  -2.2385313080 ,   0.0836938410 ,  -2.0269689405 ,  -1.7982187475 ,  -1.6560351568 ,  -1.8166446346 ,  -2.3843748168 ,  -2.3956516742 ,  -1.6860226296 ,   0.0544853358 ,   0.1198544039 ,  -1.3680050796 ,  -0.8320900618 ,   0.8449670489 ,  -2.5536089786 ,  -3.7404159754 ,  -2.5024560702 ,   2.0211185646 ,  -2.1198100379 ,  -2.2837567935 ,  -0.7337068798 ,  -1.5456591583 ,  -1.9241400533 ,  -1.1230555573 ,  -1.2775719487 ,  -0.1304243229 ,   1.8653918115],
                                [  -2.0104340523 ,  -0.6482900911 ,  -2.3626371574 ,   0.0812886819 ,   0.5903440792 ,  -0.6673798864 ,  -0.6726941424 ,  -1.2267050530 ,  -1.2255527675 ,  -0.7219393330 ,  -2.1497735849 ,   0.0681360053 ,  -0.5983324679 ,  -1.3090472115 ,   0.4475152772 ,   0.9515348318 ,  -2.3814180278 ,   0.1911382475 ,   1.6551155241 ,  -2.0824232918 ,   0.6030280869 ,  -1.7361626955 ,  -1.1938089902 ,   1.6059410429 ,   0.1060121371 ,  -1.6388574637 ,  -0.7728140247 ,   0.4573634620 ,  -1.3634633134 ,  -0.3586867950 ,  -1.6997982400 ,  -1.6743093697 ,  -0.5255686853 ,  -1.3110204654 ,  -0.5890737554 ,  -0.5062861164 ,  -1.1533968061 ,   0.2163539276 ,  -2.5540750032 ,   1.1487937175 ,  -1.3047087648 ,  -1.9032958547 ,  -0.2025990500 ,  -1.4686018932 ,  -1.6871722166 ,  -0.5269987690 ,  -1.5430930926 ,  -0.9050072139 ,  -1.7312052272 ,  -0.7631068288]
                                ])

    # FEE coefficient (10 customers x 50 draws)
    dict['Beta_FEE'] = np.array([
                                [ -42.6300269771 , -28.0548859794 , -42.8805213421 , -46.2072675768 , -32.3752754873 , -44.2080924173 , -16.7536060096 , -46.7468753965 , -19.3206815474 , -36.0237929296 , -40.0203228351 , -55.4476812774 , -35.6004843709 , -47.4627716120 , -41.1690982968 , -17.4246882172 , -41.3938256371 , -30.3568452297 , -31.5497148868 , -23.8801987228 , -32.0983369032 , -35.6152005837 , -31.4353898072 , -27.9177214323 , -66.2506786583 , -30.5985213639 ,  -6.0121697193 , -32.4833978995 , -28.2955745141 , -53.4977861410 , -22.9648354639 , -25.5582622321 , -11.4426724190 , -41.3997335344 , -23.4186889907 , -54.3798508628 , -26.5482927710 , -60.9526678434 , -18.1677402829 , -27.5195303914 , -17.6863098231 , -36.5030454570 , -38.2541056977 , -42.7778565032 , -33.3616430353 , -55.5063655095 , -67.1468724571 , -32.1749228424 , -24.8728863301 , -38.1301429992],
                                [ -25.0349083256 , -26.1094257734 , -25.7858043528 , -52.1283704312 , -50.1263869256 , -16.9251124053 ,  -7.8282150052 , -44.8206549445 , -25.5625046328 , -26.2039913835 , -23.9756021501 , -35.1658496002 , -10.8857192148 , -38.9332497193 , -23.6286655051 , -30.1344023086 , -51.7864490863 , -41.5194496436 , -34.6454815750 , -37.5873075987 , -30.8927479067 , -21.2519211037 , -53.6130707026 , -26.5423211849 , -27.2019413433 , -23.9800653168 , -31.2882680148 , -40.7878108796 ,  -9.7308461107 , -11.6585722465 , -35.2714832045 , -44.5306066059 , -14.4926763425 , -32.1600795236 , -29.0431267284 , -18.8211291704 , -42.8613936515 , -25.9211899429 , -44.0768552517 , -18.9168330961 , -25.5240328412 , -11.9818948221 , -11.3826167352 , -13.8888251156 , -14.9317946216 ,  11.2386597211 , -31.3620208726 , -21.1307524221 , -45.9294853313 , -22.4623205900],
                                [ -28.5541454549 , -34.6293429038 , -48.3414555737 , -41.6873752676 , -22.4502782004 , -52.7428566425 , -41.7261410911 , -20.4153788702 , -23.9668093840 , -28.3012359355 , -46.8949529505 , -36.1396823709 , -28.9965407696 , -37.7473137381 , -37.1834173574 , -21.0278984222 ,  -4.4032849495 ,  -8.4409881943 , -40.7654403605 , -33.0048167353 , -25.3603175661 , -25.8516627501 , -28.3346987428 , -52.3656377889 , -25.9559373825 , -46.9923089110 , -21.2962152848 , -19.4323613794 , -22.5141733793 , -23.8198621148 , -26.2322888929 , -34.0011710739 , -33.8092027264 , -28.5202934857 , -33.9250728266 , -32.9318206633 , -40.8392561237 , -31.9748402675 , -40.1326233057 , -26.7133488612 , -16.7540632093 , -40.8110667858 , -64.6171715804 , -16.9874901743 , -49.4220865651 , -26.5212997048 , -39.8331214607 , -41.4168977683 , -30.5641795924 , -20.6161181077],
                                [ -28.8521970943 , -41.3682653799 , -14.5877966206 , -37.2428950878 , -23.2362710629 , -25.2812730450 , -32.8201066663 , -42.4129627648 , -19.7732159100 , -34.1492873992 , -16.2673556269 , -25.3320442129 , -54.4249450074 , -22.4796834303 , -24.5921496297 ,  -3.4909532147 , -30.2297893548 ,  -9.9632154523 , -37.7961832663 , -33.4759246600 , -52.7119257759 , -19.8040115815 , -28.8447907958 , -21.8404005926 , -20.7309845798 , -24.3342810471 , -42.5867992330 , -10.2703496053 , -48.1389726070 , -25.7719751271 , -19.4518858485 , -37.3979022158 ,   3.4603882832 , -34.3274915498 , -30.2349748218 , -38.1943154756 , -34.1719633252 , -23.7247601804 , -21.0255252635 , -40.3830851600 , -20.7179330074 , -25.1394127456 , -26.8227203836 , -44.4047209722 , -19.9888843345 , -28.7519904041 , -42.8300519964 ,  -8.1707606991 , -36.2473692191 , -19.7666810496],
                                [ -32.4198384129 , -31.7309752926 , -42.9102357427 , -16.0468590147 , -43.3762780679 , -40.0547099692 , -43.0150437506 , -55.8262211358 , -24.6575887641 , -19.7018159348 , -39.8324683248 , -24.6291271636 , -33.2767189773 , -40.2406136086 , -22.5122477920 , -24.6368063109 , -33.3831616027 , -47.7496937062 , -12.7907242627 , -19.0969120495 , -20.7102905678 , -44.1197599614 , -42.6917129231 , -35.9054156508 , -21.4284083115 , -45.6850230964 , -59.8293712164 , -27.2984872605 , -57.4816119348 , -31.1430365283 , -22.8308785648 , -45.8362328281 , -40.2115285025 , -26.8592684053 ,  -9.7051940407 , -40.9935668197 , -19.2609346542 , -19.2124162455 , -40.1548478383 , -34.3645534626 , -30.8004444144 , -13.2457422951 , -20.4862411413 , -12.0599977568 , -51.0424148525 , -30.5152358000 , -37.3192513928 , -14.2013175719 , -36.2110987484 , -27.0350879892],
                                [ -37.7153423729 , -50.9511012654 , -28.9380836667 , -22.7156609480 , -27.5017513223 , -32.5828469075 , -46.5322887278 , -48.7090758010 , -18.8143080667 ,   0.4133035168 , -35.0936848142 , -60.8528186300 , -48.5014888049 , -16.4628282226 , -54.1058685682 , -17.1199389984 , -29.8860307329 , -44.1559693810 , -35.6066945270 , -50.9867659186 , -42.0184468105 , -36.4829081278 , -37.9956682256 , -36.2410869978 , -33.4997520143 , -16.6177666994 , -19.8220192425 , -35.6856390338 , -32.1625976454 , -28.4136202442 , -27.9445574760 , -41.3376619650 , -22.2495802017 , -34.9852313224 , -11.7324672800 , -30.1036366327 , -27.3832797800 , -32.8827099713 , -35.9911558383 , -28.7965585783 , -23.0003847580 , -29.7358760132 , -43.5678016942 , -55.1697431693 , -13.2240169968 , -43.7567928055 , -41.7004416207 , -16.6781442222 , -39.3973641460 , -25.7925889450],
                                [ -68.7603842403 , -27.8386541778 , -27.6962917294 , -41.1290036540 , -20.8938556738 , -66.7667864224 , -13.7093255972 , -27.9028699384 , -44.6927252307 , -39.4353636683 , -15.8294331174 ,  -8.4981397255 , -25.3346174738 , -18.3252955452 , -34.6941101447 , -40.2065277608 , -44.7814177433 , -37.4373368831 , -27.9500492395 , -31.0926875454 , -39.9740370032 , -25.2094553692 , -28.3370040516 , -29.1742637953 , -45.8392025050 , -19.4878812831 , -38.7723555575 , -12.1755637189 , -31.6952874468 , -37.9190557364 , -29.8345696685 , -15.3530372383 , -36.8411815110 , -40.4756287779 , -38.7429514785 , -32.0274804523 , -18.2073382311 , -55.5837722846 , -35.2537962415 , -45.9337598922 , -26.4935256225 , -26.3713883867 , -43.7096054555 , -25.4007001769 , -50.3402781812 , -24.7812394922 , -28.2682243419 , -49.4293563649 , -48.2273880178 , -36.4983339257],
                                [ -10.8055244318 , -52.1558874276 , -22.9511361571 , -53.4862807258 , -37.9599157475 , -34.2419111422 , -23.1471036055 , -61.2077779077 , -35.1525897871 , -41.0827142625 , -45.8973965009 , -24.3871134664 , -38.5749400165 , -56.7271068358 , -45.0248496775 , -52.8410585736 , -49.6833972715 , -41.3952150898 , -32.6489723671 , -34.8655615851 , -26.7338559294 , -33.3629573008 , -28.4713477719 , -28.1804413418 , -28.5275766869 , -19.3597906180 , -23.3469209615 ,  -1.8335356778 , -29.8460291925 , -10.3808185255 , -14.3196339632 , -13.1728893513 , -59.9432091342 , -36.8957578849 , -12.6217238912 , -30.8991668021 , -27.3929148879 , -11.6368390110 , -24.0329523383 , -42.2859845187 , -26.3650228890 , -39.4246740003 , -24.3188100449 , -55.4475957164 , -22.9036823828 , -34.9760989525 , -59.8985016621 , -46.5420871416 , -25.5189944605 , -29.5613544894],
                                [ -34.7055609357 , -48.1573157393 , -46.6814375381 ,  -2.2838262372 , -27.5783790467 , -27.6765430030 , -23.4496266660 , -39.8998122508 , -12.8418288403 , -45.5403316088 , -23.1393884117 , -31.4794018505 , -34.6395125787 , -53.4041446369 , -37.4941888543 , -33.1275603042 , -33.6451381654 , -48.7466051437 , -31.7984278171 , -35.4011356562 , -11.8843613208 , -36.2462369035 , -27.3714650137 , -29.2026412481 , -43.9009068723 , -33.2428098385 ,  -6.6694884277 , -47.5499086237 , -43.9356314746 , -31.9054970257 , -29.7354454865 , -41.9284067389 , -20.8653660859 , -37.2927700596 , -33.4404345497 , -51.8415150076 , -47.2898792758 , -24.3949118562 , -19.7570324197 , -11.8949761528 , -39.2418690152 , -27.0106815588 , -20.0277823730 , -36.7150532331 , -26.8443486370 , -48.7124937929 , -31.2689744285 , -41.5285731050 , -30.8430598177 , -34.3765732018],
                                [ -33.8680285417 , -37.6129567114 , -33.9875495267 , -40.7624993923 , -28.2498872082 ,   2.5084587992 ,  -6.1055659079 , -57.4856963886 ,  -4.2409457674 , -63.7431773713 , -23.8449036275 , -31.2457567538 , -30.1055223946 , -60.4362012445 , -12.4300192321 , -25.8883903275 , -21.5067385165 , -51.6143887966 , -25.4833860484 , -28.6190744015 , -39.3384937691 , -35.4623185293 , -52.0228882921 , -19.9558825339 , -29.6269673124 , -33.0393440935 , -27.9120971523 , -34.5710045985 , -37.9919177899 , -35.5250755648 , -56.2291639196 , -20.7658295341 , -35.2560130657 , -43.4326363904 , -36.9702339809 , -58.6966122321 , -34.8641929159 , -38.4267841907 , -26.3398264397 , -43.3027707262 , -14.6852460751 , -54.2578066778 , -25.1224018594 , -47.3605935532 , -33.3611780138 , -32.0714986160 , -40.0545988329 , -46.9125278014 , -44.0552240134 , -43.5305257068]
                                ])

    # Random term (Gumbel distribution (0,1)) - 3 alternatives x 10 customers x 50 draws
    dict['xi'] = np.array([
    [
    [ -0.0462562 ,  0.1479797 , -0.0343605 , -0.9386237 , -0.0640906 , -1.3058293 ,  0.5614955 , -1.8399756 , -0.0630410 , -0.0271730 , -1.8484073 , -2.1118325 , -2.2951646 ,  0.7380688 , -1.2221755 , -3.9885771 ,  0.5537314 ,  0.3113854 , -1.8718160 ,  0.3589598 , -0.4013226 , -1.4158906 , -2.7355767 , -2.0171383 ,  0.0522521 , -0.2880826 , -5.8959360 , -0.7894939 , -0.2828906 , -4.6841335 , -0.3339054 ,  1.4215387 , -1.2007917 ,  1.3579281 , -2.4484793 , -0.5895541 , -0.1967212 ,  0.8377615 , -0.2701190 ,  0.7578843 , -0.6399629 ,  1.2954451 , -1.0362160 , -1.4900792 ,  0.8766561 ,  0.2874575 ,  0.4762030 , -0.3157931 , -0.2618078 , -2.9270433],
    [  1.1156269 , -0.0121512 ,  0.6444756 , -0.8406125 ,  1.1221152 , -1.7389198 ,  0.3946229 , -1.2383862 , -1.1255147 , -1.4794986 , -0.8896547 , -1.1647583 , -1.6257791 ,  0.4569746 , -0.0440398 ,  0.0694112 ,  0.6914568 ,  0.5698484 , -0.9758580 ,  0.7255560 , -1.2988859 , -1.4364590 ,  0.6179382 ,  0.9673807 , -4.7705248 ,  1.0964520 , -1.0681775 , -0.4936264 , -1.7520389 ,  0.1503530 ,  0.6009983 , -2.5352196 , -0.4921934 ,  0.1963161 , -0.0501903 ,  0.1963161 ,  1.0485697 , -1.0726010 , -1.6986520 ,  0.1172642 ,  0.5698484 ,  0.0042774 , -0.7130788 , -0.4550301 , -2.7335065 ,  0.3456813 ,  0.6126798 ,  0.6236788 ,  0.2743278 ,  1.5326462],
    [ -0.6324151 ,  0.2259431 , -0.7400904 , -0.2131687 , -1.7053896 ,  1.2352168 , -0.7006992 , -1.1198176 , -0.1452157 , -0.7789950 ,  0.5087345 , -0.5594836 , -4.6755494 ,  1.0189233 , -0.2741868 , -0.1931568 ,  1.1044585 , -1.8593909 ,  0.9673807 , -1.3101772 , -1.1904832 , -1.4119303 ,  1.6224503 , -3.3200103 ,  0.8819904 ,  0.8596828 ,  1.6224503 , -2.6609927 , -2.3034936 ,  0.1972042 ,  1.6164783 ,  0.4911100 , -1.8449329 ,  0.5159783 ,  0.6432098 ,  0.9322211 ,  1.1715295 , -1.0327899 , -0.2556001 , -4.3681979 ,  0.5675646 , -0.8932374 ,  0.9708968 , -0.0027518 ,  0.4205032 ,  0.6790010 , -0.0512790 ,  0.0717271 ,  0.1016200 ,  0.5047765],
    [ -0.1417631 ,  0.6344738 , -0.2344718 , -1.0289667 , -0.0702813 , -0.5516610 , -0.8665252 , -0.2603875 , -1.3921420 ,  0.6336988 ,  0.4248381 , -1.4958031 , -3.0491361 , -2.1922065 ,  1.0280998 , -0.1895645 ,  0.7867244 , -0.0518078 ,  0.2416042 , -0.6868382 , -1.3684500 , -2.0805752 , -0.5112324 ,  0.6860060 , -1.5114503 ,  0.1877489 ,  0.4463805 , -0.2867375 ,  0.1726100 , -0.8886505 , -0.4924008 ,  1.2977526 ,  0.1566307 ,  1.5207853 ,  0.0714006 , -0.9564972 , -0.2529891 ,  0.6016814 , -0.3645540 , -1.1517335 ,  0.0694560 , -5.7634956 , -0.4924008 ,  0.3195611 ,  0.0750342 , -0.1094226 ,  1.2164391 , -1.5787289 , -5.4530123 , -0.5820035],
    [ -1.0379657 , -2.8220474 , -2.3905061 ,  1.2042607 , -2.1752775 , -0.7987685 ,  0.6010658 ,  0.4977202 , -1.0046095 , -1.2689861 ,  1.4035988 , -1.3553568 ,  0.2594501 ,  0.0266454 , -0.2653957 ,  0.0636863 ,  0.2941930 , -0.3833980 , -2.0189273 , -1.0252453 , -0.5971792 ,  0.9177231 , -0.4953386 , -0.2073703 , -0.0550657 , -0.5979251 ,  1.0300839 ,  0.2229561 , -1.1230684 ,  0.5499341 ,  1.0163208 ,  0.4877821 , -0.2529891 ,  0.2796723 , -0.1493361 ,  0.4733455 , -0.0721654 , -1.2740239 , -0.6854921 , -4.3681979 , -0.3469293 , -0.3803316 , -0.6340309 , -1.2858231 , -0.3144211 , -0.7550093 , -0.1179326 ,  0.9894730 , -1.5459218 , -0.0638959],
    [ -0.5618568 , -0.8761743 , -1.9636322 , -0.7484283 ,  0.1735062 , -0.1587176 ,  0.0567980 , -0.3327459 , -0.5594836 , -1.8121603 , -0.7408578 , -0.0451951 , -1.4140592 ,  1.2164391 , -0.5983220 , -0.0140683 ,  0.0032788 , -1.6756989 , -1.0866157 ,  0.5113878 ,  0.2772136 , -1.0914193 ,  0.8034873 , -1.9369404 , -2.1575270 , -0.1681017 ,  0.8340316 , -2.5359437 , -0.7758394 , -1.1230684 , -0.3598912 ,  0.9769175 , -1.3803450 , -0.1690215 ,  0.7519127 , -0.1826652 , -0.7037249 ,  0.2129377 , -0.7456537 , -0.8666596 , -1.4035662 , -0.6401811 ,  0.2541996 ,  0.2810907 ,  1.2441597 , -0.2803022 , -1.0866157 , -0.9256477 , -0.7501267 ,  1.3541735],
    [ -0.4143144 ,  1.2247109 , -0.7220180 , -1.0757021 ,  0.7534979 ,  0.2004483 , -0.6506642 , -0.1116704 , -0.0079371 ,  0.9303406 ,  1.1877644 , -2.7335065 ,  0.0748818 , -0.1591331 , -0.2553895 , -0.5989786 , -0.7455666 , -1.2271419 ,  1.0226513 ,  0.2098085 , -3.9892996 ,  0.4445669 ,  0.2098085 , -0.7778863 , -0.7747399 ,  0.4019700 , -0.0984352 , -0.7664556 , -1.6142814 , -2.1837796 , -0.1903507 , -0.6513049 , -4.9968161 , -2.5359437 , -1.0078575 ,  0.0717271 ,  0.5128701 , -0.1787197 , -3.6756523 , -0.0262815 , -1.1215727 , -0.0732692 , -1.4051272 , -0.8011651 , -0.3072540 , -1.1140490 ,  0.4106074 , -0.2251972 , -1.1635992 ,  0.2706440],
    [ -1.1398439 , -2.5545083 , -1.8049711 ,  0.6844703 ,  0.5037059 ,  1.2085557 ,  0.6249816 , -1.0094472 ,  0.0680328 , -1.8007262 ,  0.2196079 , -0.6625039 ,  0.5360674 , -0.4815240 ,  0.3113987 , -1.9658342 , -0.1866945 , -0.8043428 , -1.7620371 ,  0.1406313 , -0.7811918 , -0.8824308 ,  0.7599310 , -3.2200604 , -0.6057209 ,  0.7380139 , -0.0462562 ,  0.0791725 ,  0.7842738 , -0.9408383 , -0.5268588 ,  0.9173895 ,  0.6341726 , -1.2212912 , -1.6880653 , -2.5301035 , -1.1378667 , -2.0694389 ,  0.7354372 , -1.7228272 , -0.7616124 ,  0.8077555 , -3.4325909 ,  0.6340435 ,  0.3010219 , -0.0222350 ,  0.7948548 , -0.1917513 ,  1.1763026 ,  0.7560907],
    [ -0.7408578 , -3.1003689 , -1.7514124 , -0.2291591 ,  0.8629402 , -0.4503910 ,  0.0564970 , -2.6745502 ,  0.5845983 , -3.4634250 , -1.2858231 ,  1.0397217 , -0.9584390 , -0.2634036 ,  0.0830677 ,  0.5296392 , -0.1787197 ,  0.5888447 ,  0.1080522 , -0.1528705 , -0.5391222 , -1.8999728 , -0.3517652 , -0.3377391 , -1.2221755 ,  0.2431262 ,  0.2259431 ,  0.6978845 ,  0.3950987 ,  0.5007134 , -0.1865056 ,  1.9006539 , -0.6462950 ,  0.2789905 , -1.1670461 , -0.2551944 , -0.8454033 , -0.1181150 , -0.6274663 ,  0.4072892 ,  0.4199022 , -1.3183533 , -1.1647583 , -0.3806016 ,  0.9177231 , -0.6490393 , -0.6149181 ,  0.5642176 , -1.2652761 , -0.9709325],
    [ -0.3620642 , -2.7481216 , -0.5684058 ,  0.8377615 , -1.3475715 ,  0.0051600 , -0.1334714 ,  0.6403427 ,  1.1590521 , -0.9584390 , -0.1992218 , -0.8796573 ,  1.6182247 , -1.7583485 ,  0.4859003 , -0.6546589 , -0.7649291 ,  0.4431222 , -0.1312122 ,  0.3161930 ,  0.5484488 ,  0.6307739 , -1.5512516 , -2.2621698 , -0.4576563 , -0.9584390 , -1.2721496 , -2.3241601 ,  1.1525978 ,  1.6411381 , -0.4477319 ,  0.5173227 , -0.1305941 , -1.0745145 , -1.2296430 , -1.1106386 , -1.7520389 , -0.8399321 ,  0.4367946 , -0.3973782 ,  0.6374001 , -0.4143144 , -0.3760876 , -0.8925095 , -3.1038952 , -0.0100176 , -1.5831897 , -0.7620408 ,  0.0717271 , -0.0099433]
    ],
    [
    [ -1.7751668 , -0.9845483 , -0.0483044 , -0.8321271 , -0.4715458 , -0.4246387 , -2.2033349 ,  0.3694754 , -1.7000721 , -0.2437955 , -0.2344144 , -2.3904533 , -0.5265911 , -3.8225006 , -1.1532237 , -1.0908413 , -0.9547779 ,  0.6847390 ,  0.6539868 , -1.4031505 ,  0.2981386 ,  1.2164391 , -1.2271419 , -2.0449494 ,  0.6444756 , -1.1534606 , -1.0909456 , -2.5834489 ,  0.4311600 ,  0.6054741 ,  0.7989255 , -1.0181664 , -3.2352083 , -0.5468047 ,  0.4988622 ,  0.1572591 , -0.4516927 , -0.7778863 ,  1.0150754 , -1.7520389 , -1.2948094 ,  0.4367226 , -3.0491361 , -0.6819680 , -0.2060315 , -0.3427294 ,  0.6960130 , -0.7444803 , -1.2839675 , -1.1386997],
    [ -0.2285654 , -2.2786609 ,  0.4978645 ,  0.2212255 ,  0.0077045 , -3.6396781 , -0.3478543 , -2.6752076 ,  0.0253707 ,  0.5941175 , -4.2749022 ,  0.8480465 , -2.0441068 ,  0.7151201 ,  1.2293753 ,  0.3376768 ,  0.1506914 , -0.9967079 , -1.2440271 , -2.8539482 , -1.4455710 ,  0.1930787 ,  1.8435034 ,  0.8800459 , -0.2713549 , -1.2490099 ,  0.6340435 , -1.3803450 , -0.9164054 , -1.5432469 , -0.6427277 , -1.4389593 , -0.9397318 ,  1.1499877 ,  0.1191553 ,  1.5055528 ,  0.7034215 , -3.1822074 , -2.3122000 , -3.0830126 , -0.7778863 ,  0.3448285 ,  0.8044861 , -1.8643434 ,  1.0387427 ,  0.3259091 ,  0.9220653 , -1.8649937 , -0.2576088 , -0.7656382],
    [  0.6859771 ,  0.7844747 , -0.1572901 , -0.5463247 ,  0.2259330 ,  0.3945492 ,  0.1606786 , -1.4710890 , -0.5731234 ,  0.1740120 , -0.2002337 ,  0.2045453 , -1.0510136 , -0.6448771 , -0.1403997 , -3.9892996 , -0.1179326 , -0.2690891 , -1.6986520 , -0.1780897 , -0.4489734 , -1.7287397 , -1.1527580 , -1.2134493 , -1.0363318 , -1.9228752 ,  0.4019700 ,  0.3789404 , -1.2845063 ,  0.3911665 , -3.5470873 , -1.1755150 , -0.4114203 , -0.2604918 ,  0.3371848 , -2.9431232 ,  0.3198485 ,  0.7486567 ,  1.4872850 , -2.7481216 ,  0.0096420 , -1.2790161 , -2.2065333 ,  1.6110623 , -0.5198303 , -2.4991573 ,  0.0323581 , -1.0132070 ,  1.1906130 ,  1.0084054],
    [ -1.9821515 , -0.3787844 , -1.0510136 , -0.6295328 ,  0.2547418 , -1.0788198 ,  0.1652154 , -1.3516557 , -0.4755812 ,  0.3113854 ,  0.0266454 ,  0.2091875 ,  1.2166438 , -2.6977364 , -0.7851956 , -3.8063680 ,  0.6330046 ,  1.1499877 , -0.5630128 , -0.4725243 ,  0.3448285 , -0.0577619 ,  0.1506914 , -1.2308697 , -0.7680708 , -1.4622848 ,  0.6989943 , -3.2901406 , -2.1118325 , -1.2280439 , -0.0694431 , -0.6838086 , -2.0375577 , -3.4756462 ,  0.4743984 , -1.3803842 , -2.8986064 , -0.4114355 ,  0.9711750 , -0.5548212 , -1.1611279 , -0.5112324 ,  1.4024327 ,  1.6164783 , -0.6721661 , -0.1767574 ,  0.7864637 , -0.9747916 , -0.7851956 , -1.9837033],
    [ -0.6722932 , -0.3776567 ,  0.3444105 , -2.4310179 , -0.3776567 , -0.0258382 ,  0.9611302 , -1.0913554 ,  0.5270719 , -0.1144727 , -1.0078575 , -3.6893199 , -0.1998358 , -0.2285654 , -1.1301613 ,  0.2045453 , -0.9408383 , -0.6210404 ,  0.6026345 , -0.2409219 ,  0.6403427 ,  0.4581368 , -1.4920105 , -0.9428673 ,  0.0656215 , -0.3645540 ,  1.0217092 , -0.5198303 , -0.8951733 ,  0.3945492 ,  0.1511199 , -4.5035411 , -1.8726254 , -0.1780897 , -0.3833980 , -0.2251511 ,  1.0523698 , -0.6868382 , -0.7612663 , -0.3363586 , -0.9232484 , -0.0346953 , -1.2250960 ,  0.7196401 ,  0.2355502 , -2.2233305 , -2.3054882 , -2.3042734 ,  0.5700343 , -0.6672701],
    [ -0.6217521 ,  2.1640009 , -0.5977966 , -0.6462950 ,  0.4978645 , -2.7147775 , -0.6505043 , -1.8121603 ,  0.2017968 , -1.4710890 , -0.9586245 ,  0.3406252 , -0.1645823 ,  0.5128701 , -0.2882767 , -0.0735642 , -2.3092701 ,  0.0279533 ,  1.0289690 , -0.5971792 , -0.6809812 ,  0.2496253 , -3.1621351 , -0.9286239 , -1.4021260 ,  0.0588327 ,  0.2004483 , -0.7443434 ,  0.0279533 , -0.1309121 , -0.8169889 ,  0.2559494 , -4.6566084 , -1.8848068 , -2.1887001 , -0.0794137 , -0.8776420 , -1.3567274 , -1.9241115 , -1.6937774 , -0.1945978 , -0.8434831 ,  0.8340316 ,  0.6539868 , -0.7223098 , -2.1061255 , -0.1238779 ,  0.4528585 , -0.6210404 , -3.0606206],
    [  1.2323036 , -0.0458388 , -0.1627402 , -3.3061410 ,  0.0942773 ,  0.1506914 , -2.0441068 ,  0.5725745 ,  0.1131575 ,  0.1178592 ,  0.3535893 , -0.5060280 , -2.3905061 ,  0.2762283 ,  1.0532876 , -1.8461610 , -1.2740676 , -0.8321271 , -3.2481487 , -0.2751056 , -0.0402770 ,  0.6896956 , -0.3944385 , -0.3407587 ,  0.4463805 , -1.5052001 ,  0.5335593 , -0.7062235 ,  0.8981838 , -0.9179926 , -0.4915540 ,  0.3754119 ,  1.0706880 , -4.2508035 ,  1.0477220 , -0.5779482 , -1.7257172 ,  1.4630288 , -0.2674051 , -0.3448299 , -2.0849419 ,  0.3414946 , -0.7889288 , -0.7588868 , -1.2014363 , -1.2538316 , -2.5681423 ,  0.4052376 ,  0.3085060 , -1.2319634],
    [ -3.1947516 , -0.0506852 , -2.3706460 , -0.3508042 , -0.6479828 ,  0.3375010 ,  0.4431014 , -1.5757293 , -0.0680413 , -0.7894939 , -1.1072802 , -0.9747916 ,  0.8975047 , -1.5560564 , -0.7484283 ,  0.4828340 , -0.1587176 , -0.5761080 ,  0.8968229 ,  0.4911100 , -1.0689479 ,  0.0730688 ,  0.4881936 , -0.9954477 ,  0.6978725 , -2.1575270 ,  2.0103781 , -0.2297798 , -0.1855322 , -0.2861165 , -0.6438436 ,  0.1131575 , -1.1230684 , -2.6985303 , -0.1238779 , -1.0092127 ,  0.5325295 ,  1.2442124 , -0.6768446 ,  0.0567980 , -0.0306203 , -2.5253899 ,  0.1651346 , -0.3125894 , -4.9968161 , -3.9733928 ,  0.5572525 , -0.2205386 ,  0.4678586 ,  0.6882453],
    [  0.1300599 , -2.8040542 , -1.0959039 , -1.2675457 , -0.4222227 ,  0.0889064 , -0.1091632 , -4.5025711 ,  0.0656215 , -1.4695971 ,  0.3372492 ,  0.2290649 ,  1.0886854 ,  0.2198519 ,  0.5255674 ,  0.0830677 ,  0.8748918 , -1.3516235 , -1.2149928 , -0.6381718 , -1.0911356 , -0.1179326 , -2.5346108 , -2.3092701 ,  0.7345944 , -0.2755335 ,  0.4223311 , -1.5450174 , -0.3069462 , -1.1863843 ,  0.2607823 ,  0.6514450 ,  0.0041106 , -0.6074235 , -0.5519748 , -2.3270224 ,  1.0459183 , -6.7544792 , -0.4830094 ,  0.9537217 , -1.3703726 , -0.2359867 , -0.0424937 ,  0.1066765 , -0.1786371 , -0.9026567 , -0.5914035 , -1.1553947 , -2.3035498 , -0.8165872],
    [ -1.5101771 , -1.1769306 , -1.9658342 , -2.9608453 ,  1.4984652 ,  0.2151927 , -0.1977829 ,  0.0805352 , -1.4051272 , -0.9639598 , -0.7375282 , -0.1328456 ,  0.0473070 , -0.6115019 , -0.0284747 ,  0.3520975 , -4.6566084 ,  0.8644041 ,  0.2700021 ,  0.1471556 ,  0.6179382 ,  1.0862708 ,  0.6909575 ,  0.8994299 , -1.0325316 , -0.1998358 ,  0.1933931 ,  0.4586043 , -0.8676969 ,  0.7471114 ,  0.9346246 , -1.9263324 ,  1.2959877 , -0.5684058 ,  0.4575279 , -0.1542991 ,  0.8948751 ,  2.1640009 ,  0.6249816 , -1.8391927 ,  0.0767837 , -2.0779732 , -2.4484793 , -2.1439741 , -0.6973464 , -0.0630410 ,  0.3994510 , -0.6154826 , -0.4528707 ,  1.0413869]
    ],
    [
    [ -0.4566286 , -1.9361634 , -2.2640342 ,  0.1745818 ,  0.7456599 ,  0.3649175 ,  0.5575881 ,  0.3139500 , -1.9506812 , -0.7723307 , -1.3237248 , -1.5273951 , -1.8963107 , -1.4418906 , -5.3039091 ,  0.5417194 ,  1.3174193 ,  0.1124685 ,  0.9686236 ,  0.2789817 ,  0.5102524 , -1.0289667 , -0.9427924 , -1.2845063 ,  0.2706440 , -0.5908512 , -2.5806311 , -4.5112358 , -1.6681222 ,  0.6621900 ,  1.0949044 , -2.9440821 , -1.0078575 , -1.8481319 ,  0.1462419 , -3.1582344 ,  0.4746648 ,  0.5593611 ,  1.1422517 , -0.6838086 ,  0.1695119 , -1.1386997 , -0.9519154 , -1.2790161 , -2.5576806 ,  0.1412662 , -0.1839077 , -0.2995404 , -3.4533403 , -0.7312481],
    [  0.4877821 , -0.6149181 ,  1.3579281 , -0.1993073 , -1.4619080 , -1.8797211 ,  0.5698484 , -1.6880653 , -1.1263144 ,  0.3496922 ,  0.2198519 , -0.7072009 ,  0.1491629 , -0.8321271 ,  0.4971036 , -2.5233637 ,  0.4336740 ,  0.3038765 , -0.7316187 , -1.5787289 , -0.7987685 , -0.5482815 ,  0.7143367 ,  0.5080019 ,  0.2388007 , -0.5225744 , -0.5761080 , -0.0048602 ,  0.5085996 , -0.3886712 , -0.7121305 , -2.9263889 , -0.0984025 ,  1.3771375 , -0.2235725 , -0.5201457 ,  0.9792155 ,  0.5980789 ,  0.8170694 ,  0.5817831 , -1.3690868 , -0.4755812 , -1.1521319 ,  0.5510291 , -2.0955188 , -1.6210422 , -4.9976968 , -0.7877887 ,  0.0920155 , -3.5576165],
    [ -1.1866121 , -0.2783388 , -0.2803022 ,  0.2517289 , -0.7630405 , -0.2527576 , -2.0694389 ,  1.1031936 , -1.6630939 , -1.9801620 ,  1.2784929 , -0.9812807 , -0.8776420 , -0.0346953 , -0.0668893 , -3.4401663 , -0.2508972 , -1.3516235 ,  0.2193789 , -1.8960650 , -0.3069462 , -0.1444549 , -0.5800303 ,  1.0847608 , -1.8960650 , -0.4751719 , -1.7257172 , -0.1191744 , -0.0306745 ,  0.4670594 , -2.6936388 , -1.0234868 ,  0.5102524 , -2.5921372 ,  0.6052455 , -1.1093519 , -0.6607192 , -2.0875681 , -2.7304920 , -1.9484972 , -0.5166833 ,  0.2411826 , -1.5180980 , -0.7386463 ,  0.9809067 , -2.5921372 ,  1.1334191 ,  0.1945450 ,  0.6945990 , -1.8369616],
    [ -0.0506043 , -0.7695451 ,  1.2977526 ,  0.1179048 , -0.7547465 , -0.6693044 ,  0.5724153 , -0.3160384 , -0.3967814 ,  0.4223311 ,  1.1590521 ,  1.1319047 ,  1.8645148 ,  0.1067989 , -1.6177172 ,  0.3496922 ,  0.4818341 , -0.6242889 , -4.5332359 , -0.2343167 ,  0.0792065 ,  0.7224755 , -0.1305941 , -0.6393918 ,  0.4670594 , -0.9448471 , -1.6806712 , -1.2484899 ,  1.6040639 ,  1.0618423 ,  0.6178254 , -0.4712994 , -0.4477319 ,  0.4702009 ,  0.4112338 , -0.6940667 , -0.7375282 ,  0.5884698 ,  0.7496441 , -1.3171220 , -0.5157026 ,  1.7690748 ,  0.1537871 ,  0.4454978 , -1.4741335 , -0.2718505 , -0.1810598 , -1.4576112 , -2.0189273 ,  0.2321453],
    [  0.5642176 , -0.6386270 , -3.5417477 ,  0.3596928 , -3.7443126 , -1.9263324 ,  1.0145177 , -0.2713549 , -0.1350974 , -1.6107478 , -1.2858091 ,  0.4634302 ,  0.3891189 ,  1.3019032 , -0.4425039 , -0.1373309 , -1.3475715 , -1.0792623 ,  0.4108058 ,  0.3660026 , -0.0151110 , -0.5321498 ,  1.2309651 , -0.4936264 , -2.9431232 ,  0.9767858 ,  0.2762283 , -3.7016056 ,  0.3117293 ,  1.3210443 , -1.4035662 ,  0.2642699 ,  0.1638025 ,  1.1423613 ,  0.8677570 , -0.8912047 ,  0.2944925 , -2.0620797 , -0.7713229 , -3.8420567 ,  0.1755001 ,  0.1959690 , -0.2569421 , -2.3083449 ,  1.3345124 , -3.0113818 , -0.3202488 ,  0.3819645 ,  0.2121472 , -1.0913554],
    [ -2.5804683 , -0.5712849 , -0.5977966 , -0.6973464 , -0.1198805 ,  0.9252000 , -0.7379708 ,  0.1045698 , -2.6936388 , -0.3542975 ,  0.6795067 ,  0.4414700 , -1.0441816 ,  0.6463209 , -1.9401010 ,  0.0494356 , -0.7612663 , -0.2783960 ,  0.5413432 , -0.4661207 , -0.2004175 , -0.6087768 , -0.2244479 ,  0.3535893 ,  0.4912395 , -0.5245124 ,  0.4988246 ,  0.1503530 , -1.7952214 , -0.5351437 ,  0.8947393 , -0.4851492 , -0.6310780 , -1.1527580 ,  0.3529106 , -0.1579679 , -0.9428673 , -0.5738836 , -1.4511487 , -1.7684992 ,  0.1850333 ,  0.2944925 ,  0.1393136 ,  0.7163887 ,  0.3506503 ,  0.8074801 ,  0.8580025 , -1.6701668 ,  0.6784781 ,  0.2974385],
    [ -0.6034039 , -0.1437595 ,  1.5509110 ,  0.5586291 ,  0.5884698 ,  1.2533694 ,  0.6463209 ,  0.4528585 , -0.9745637 , -0.2576088 , -0.3620642 , -0.1938608 , -1.3521308 , -0.1974976 , -0.8825213 , -0.5654538 , -0.1039771 , -2.8040542 , -4.4822327 , -1.1795108 ,  0.0805853 , -0.5879864 , -0.2877487 , -1.8581498 ,  0.8072856 , -0.8071960 , -0.7722242 ,  0.4544374 ,  0.4988622 ,  1.0747063 , -1.8781438 ,  0.6456006 , -0.1400808 , -1.2714481 ,  0.0077045 ,  0.6775428 ,  1.1187972 , -0.8473555 , -2.3122000 ,  1.0288248 , -0.1868350 ,  0.3515483 , -1.5217503 , -2.9127699 , -1.3071191 , -1.5114503 , -2.6776623 , -0.6672701 , -5.3735337 , -0.0640906],
    [  0.8975047 ,  0.0067559 ,  0.1895867 , -0.0038543 , -3.5424764 , -1.1879228 ,  0.4499997 ,  0.2888349 ,  1.0116213 , -3.9206065 ,  0.2556795 ,  1.1321100 ,  0.1673387 ,  0.0104351 , -1.2198966 ,  1.3981924 ,  1.5645525 , -2.4926859 , -0.6309002 , -2.2400507 , -0.1232538 , -3.0569103 ,  0.6010658 , -0.5225744 , -0.7625995 , -0.0618687 ,  1.3579281 ,  0.5687050 , -0.1548281 , -4.9415684 , -1.6161119 , -0.2972837 , -0.9427239 , -2.6536325 ,  0.9508988 , -0.5968966 ,  1.1156269 , -0.6758317 , -0.1787197 ,  0.6009983 ,  0.3188255 ,  0.1853135 , -0.2497988 , -0.7130788 , -1.4959087 , -1.1065869 ,  0.1828105 , -0.4191638 , -1.1611279 ,  0.8766561],
    [ -0.6386270 ,  0.8961510 , -3.8091470 , -1.7532799 ,  0.8019243 , -0.9126090 ,  0.8596828 ,  0.2196079 ,  1.1138062 ,  1.3022830 , -2.7185978 ,  0.7769932 ,  0.4632339 ,  0.6012555 ,  1.4330339 , -0.7056688 , -1.0745145 , -0.5403609 , -1.3425750 , -3.9520601 ,  0.1745818 , -3.5176410 , -2.6609927 , -0.2690891 ,  0.5586291 ,  0.5786710 , -0.0281088 , -1.9228752 , -0.2573933 ,  0.9365781 , -0.1939249 , -0.0732692 ,  0.0607713 ,  0.6790010 ,  0.7407303 , -1.7728923 ,  0.4160438 , -2.8455467 ,  0.3093762 , -1.3766856 ,  0.6149895 , -2.1024124 , -1.7257172 , -4.2959536 ,  1.4972837 ,  0.9508988 , -0.1480093 , -2.3034936 , -0.6797792 ,  0.0588327],
    [ -3.1816216 ,  0.6656379 ,  0.4738752 , -0.6479828 ,  0.6881722 , -0.1260430 , -0.5496984 , -1.5527336 ,  0.0236888 ,  1.0145177 ,  1.2784929 , -0.9179926 , -1.2839675 , -0.7239634 , -1.4158906 , -0.5650708 , -0.5252313 , -1.2645079 , -1.3069099 , -0.3313712 , -0.6288793 , -1.1246792 , -0.1480093 , -2.2999743 , -3.8063680 , -1.2484899 , -2.3513611 ,  1.5055528 , -2.2088696 , -5.7928244 ,  0.0942446 ,  0.6859336 , -0.0271730 , -0.1403997 ,  0.6307739 ,  0.8406688 , -0.9512341 ,  0.0863713 , -2.1603921 ,  0.1666142 ,  0.7662022 , -0.0491705 , -1.1819370 , -0.8498789 , -0.7853807 , -0.6704479 ,  0.2976676 , -1.0980415 , -3.0223551 , -0.4919024]
    ]
    ])

    # Variables choice model
    dict['AT_FSP'] = 10
    dict['TD_FSP'] = 10
    dict['Origin'] = np.array([0,1,1,0,0,1,0,0,1,0])
    dict['AT_PSP'] = 10
    dict['TD_PSP'] = 10
    dict['AT_PUP'] = 5
    dict['TD_PUP'] = 10
    dict['Age_veh'] = np.array([0,0,0,1,0,0,1,0,0,0])
    dict['Low_inc'] = np.array([1,1,1,1,1,0,1,1,1,1])
    dict['Res'] = np.array([1,1,1,0,1,1,0,0,1,1])

    # Big M value
    dict['M_Rev'] = 50.0

    return dict

def preprocess(dict):
    ''' Precomputation on the data in order to create the corresponding
        cplex model.
    '''

    ########## Precomputation ##########

    # Priority list
    priority_list = np.empty([dict['I'] + 1, dict['N']])
    for i in range(dict['I'] + 1):
        min = 1
        max = dict['N']
        for n in range(dict['N']):
            if dict['ChoiceSet'][i, n] == 1:
                priority_list[i, n] = min
                min += 1
            else:
                priority_list[i, n] = max
                min -= 1
    dict['PriorityList'] = priority_list

    # Generate prices
    p = np.empty([dict['I'] + 1, dict['nPriceLevels']])
    for i in range(dict['I'] + 1):
        for l in range(dict['nPriceLevels']):
            p[i, l] = dict['lb_p'][i] + (dict['ub_p'][i] - dict['lb_p'][i])*float(l)/dict['nPriceLevels']
    dict['p'] = p

    # Exogene utility
    exo_utility = np.empty([dict['I'] + 1, dict['N'], dict['R']])
    for n in range(dict['N']):
        for r in range(dict['R']):
            for i in range(dict['I'] + 1):
                if i == 0:
                    # Opt-Out
                    exo_utility[i, n, r] = (dict['Beta_AT'][n, r] * dict['AT_FSP'] +
                                           dict['Beta_TD'] * dict['TD_FSP'] +
                                           dict['Beta_Origin'] * dict['Origin'][n])
                elif i == 1:
                    # PSP
                    exo_utility[i, n, r] = (dict['ASC_PSP'] +
                                           dict['Beta_AT'][n, r] * dict['AT_PSP'] +
                                           dict['Beta_TD'] * dict['TD_PSP'])
                else:
                    # PUP
                    exo_utility[i, n, r] = (dict['ASC_PUP'] +
                                           dict['Beta_AT'][n, r] * dict['AT_PUP'] +
                                           dict['Beta_TD'] * dict['TD_PUP'] +
                                           dict['Beta_Age_Veh'] * dict['Age_veh'][n])
    dict['ExoUtility'] = exo_utility

    # Beta coefficient for endogenous variables
    beta_FEE_PSP = np.empty([dict['N'], dict['R']])
    beta_FEE_PUP = np.empty([dict['N'], dict['R']])
    for n in range(dict['N']):
        for r in range(dict['R']):
            beta_FEE_PSP[n, r] = (dict['Beta_FEE'][n, r] +
                                 dict['Beta_FEE_INC_PSP'] * dict['Low_inc'][n] +
                                 dict['Beta_FEE_RES_PSP'] * dict['Res'][n])
            beta_FEE_PUP[n, r] = (dict['Beta_FEE'][n, r] +
                                 dict['Beta_FEE_INC_PUP'] * dict['Low_inc'][n] +
                                 dict['Beta_FEE_RES_PUP'] * dict['Res'][n])
    dict['EndoCoef'] = np.array([np.zeros([dict['N'], dict['R']]), beta_FEE_PSP, beta_FEE_PUP])

    # Calculate bounds on the utility
    lb_U = np.empty([dict['I'] + 1, dict['N'], dict['R']])
    ub_U = np.empty([dict['I'] + 1, dict['N'], dict['R']])
    lb_Umin = np.full((dict['N'], dict['R']), np.inf)
    ub_Umax = np.full((dict['N'], dict['R']), -np.inf)
    M = np.empty([dict['N'], dict['R']])
    for n in range(dict['N']):
        for r in range(dict['R']):
            for i in range(dict['I'] + 1):
                    if dict['EndoCoef'][i, n, r] > 0:
                        lb_U[i, n, r] = (dict['EndoCoef'][i, n, r] * dict['lb_p'][i] +
                                        dict['ExoUtility'][i, n, r] + dict['xi'][i, n, r])
                        ub_U[i, n, r] = (dict['EndoCoef'][i, n, r] * dict['ub_p'][i] +
                                        dict['ExoUtility'][i, n, r] + dict['xi'][i, n, r])
                    else:
                        lb_U[i, n, r] = (dict['EndoCoef'][i, n, r] * dict['ub_p'][i] +
                                        dict['ExoUtility'][i, n, r] + dict['xi'][i, n, r])
                        ub_U[i, n, r] = (dict['EndoCoef'][i, n, r] * dict['lb_p'][i] +
                                        dict['ExoUtility'][i, n, r] + dict['xi'][i, n, r])
                    # Bound for each customer, for each draw
                    if lb_U[i, n, r] < lb_Umin[n, r]:
                        lb_Umin[n, r] = lb_U[i, n, r]
                    if ub_U[i, n, r] > ub_Umax[n, r]:
                        ub_Umax[n, r] = ub_U[i, n, r]

            # Calcule the big-M values
            M[n, r] = ub_Umax[n, r] - lb_Umin[n, r]
    dict['lb_U'] = lb_U
    dict['ub_U'] = ub_U
    dict['lb_Umin'] = lb_Umin
    dict['ub_Umax'] = ub_Umax
    dict['M_U'] = M

if __name__ == '__main__':
    dict = getData()
    preprocess(dict)
